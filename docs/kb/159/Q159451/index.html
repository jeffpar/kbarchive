<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q159451: INFO: Installing LPR Ports with Windows NT 4.0 Unattended Setup | KnowledgeBase Archive</title>
<meta property="og:title" content="Q159451: INFO: Installing LPR Ports with Windows NT 4.0 Unattended Setup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/159/Q159451/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/159/Q159451/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/159/Q159451/","publisher":null,"image":null,"headline":"Q159451: INFO: Installing LPR Ports with Windows NT 4.0 Unattended Setup","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q159451-info-installing-lpr-ports-with-windows-nt-40-unattended-setup">Q159451: INFO: Installing LPR Ports with Windows NT 4.0 Unattended Setup</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q159451
Product(s): Microsoft Windows NT
Version(s): winnt:4.0
Operating System(s): 
Keyword(s): kbsetup kbOPK kbSBK
Last Modified: 09-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Workstation version 4.0 
- Microsoft Windows NT Server version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

Although there is an option in the Unattended Setup to install TCP/IP printing,
there is no option available to actually install the LPR port. To install the
LPR port in an unattended method, the OEMPreinstall features of unattend must be
used.

MORE INFORMATION
================

To install LPR ports on a system, the user must be a member of the administrator
group. An advantage of installing LPR ports during an unattended setup is that
the administrator is not required to log on to each workstation to install the
port. A disadvantage of this procedure is that each different LPR port
configuration required for the workstations will need a separate installation
point on the network. Each installation point requires about 80 MB of disk
space.

To install an LPR port (or ports), perform the following steps:

1. Install Microsoft TCP/IP Printing on a Windows NT Workstation or Server
  through Control Panel, Network, Services.

2. After restarting the computer, install the LPR ports with the correct IP
  addresses and desired names through Control Panel, Printer, File, Server
  Properties.

3. Open Regedit.exe (not Regedt32.exe) and go to the

  HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Control/Print/Monitors/ 
  LPR Ports/Ports

  subkey. Under Ports, select the IP address and name of the printer you just
  installed. Click Registry/Export Registry File from the menu. Save it as
  Lpr.reg. Do this with each LPR port you have installed, making sure to give
  each .reg file a unique name. Close REGEDIT.

4. Go to the network installation point for Windows NT. Create a subdirectory
  under i386 labeled $oem$. Copy Regedit.exe and the .reg files created in step
  3 to this directory.

5. Create a text file in the $oem$ directory using Edit.com called Cmdlines.txt.
  Add these lines, including quotation marks:

  [Command] ".\regedit /s .\lpr.reg"

  Add an additional line for each port you are installing with the appropriate
  .reg file name.

6. Modify the Unattend.txt file using Edit.com to do an OEMPreinstall and
  automatically install TCP/IP protocol and TCP/IP printing.

7. Run setup from the i386 directory with the following command line:

  winnt /b /s:&lt;sourcefiledir&gt; /u:&lt;unattend file name&gt;

  This procedure will install the LPR ports created in Step 2.

Additional Information
----------------------

The example provides only part of the answer file needed for a complete Windows
NT 4.0 unattended installation.

For additional information, please see the following article in the Microsoft
Knowledge Base:

  ARTICLE-ID: Q155197
  TITLE : Unattended Setup Parameters for Unattend.txt File

Additional query words: prodnt Unattended Setup Install

======================================================================
Keywords          : kbsetup kbOPK kbSBK 
Technology        : kbWinNTsearch kbWinNTWsearch kbWinNTW400 kbWinNTW400search kbWinNT400search kbWinNTSsearch kbWinNTS400search kbWinNTS400
Version           : winnt:4.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>