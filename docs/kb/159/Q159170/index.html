<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q159170: XADM: Calling HRBackupGetDatabaseNames Returns Invalid Parameter | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q159170: XADM: Calling HRBackupGetDatabaseNames Returns Invalid Parameter" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/159/Q159170/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/159/Q159170/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/159/Q159170/","headline":"Q159170: XADM: Calling HRBackupGetDatabaseNames Returns Invalid Parameter","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q159170-xadm-calling-hrbackupgetdatabasenames-returns-invalid-parameter">Q159170: XADM: Calling HRBackupGetDatabaseNames Returns Invalid Parameter</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q159170
Product(s): Microsoft Exchange
Version(s): winnt:4.0
Operating System(s): 
Keyword(s): 
Last Modified: 09-APR-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

After installing Microsoft Exchange Server Service Pack 3 (SP3), using the
HRBackupGetDatabaseNames call from the Microsoft Exchange Software Developers
Kit (SDK) may stop with the following error message:

  Return Code: 0x57 - invalid parameter

CAUSE
=====

A new version of Edbbcli.dll was included in Service Pack 3 to fix a problem
when using Windows NT4.0 to remotely backup a computer that is running both
Microsoft Exchange Server and Windows NT 3.51.

Producing this fix introduced an error in the conversion of an ASCII string to
uni-code. NTBackup uses uni-code directly and this error causes the call to
HRBackupGetDatabaseNames to be handled incorrectly and return the "invalid
parameter."


WORKAROUND
==========

Replace the SP3 version of Edbbcli.dll in the &lt;winntdir&gt;\System32
directory with the version shipped in Microsoft Exchange Server Service Pack 2
or Microsoft Exchange Server version 4.0a.

RESOLUTION
==========

Obtain the fix referenced below. Edbbcli.dll was updated to properly handle the
ASCII to uni-code conversion.

STATUS
======

Microsoft has confirmed this to be a problem in Microsoft Exchange version 4.0.
This problem was corrected in the latest Microsoft Exchange 4.0 U.S. Service
Pack. For information on obtaining the service pack, query on the following word
in the Microsoft Knowledge Base (without the spaces):

  S E R V P A C K


MORE INFORMATION
================

This problem is primarily seen by those using Cheyenne's Arcserve backup and
Cheyenne's Exchange Database Agent software after applying Microsoft Exchange
Server Service Pack 3.

The third-party products discussed here are manufactured by vendors independent
of Microsoft; we make no warranty, implied or otherwise, regarding these
products' performance or reliability.

REFERENCES
==========

For additional information, please see the following article in the Microsoft
Knowledge Base:

  Q156715 XADM: Unable to Back Up Exchange on Remote Server from NT 4.0

Additional query words:

======================================================================
Keywords          :  
Technology        : kbExchangeSearch kbExchange400 kbZNotKeyword2
Version           : winnt:4.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>