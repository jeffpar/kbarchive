<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q259861: SMS: Queries Do Not Show Results without Class Rights | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q259861: SMS: Queries Do Not Show Results without Class Rights" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/259/Q259861/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/259/Q259861/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/259/Q259861/","headline":"Q259861: SMS: Queries Do Not Show Results without Class Rights","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q259861-sms-queries-do-not-show-results-without-class-rights">Q259861: SMS: Queries Do Not Show Results without Class Rights</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q259861
Product(s): Microsoft Systems Management Server
Version(s): 2.0
Operating System(s): 
Keyword(s): kbMMC kbSecurity kbWBEM kbsms200 kbsms200bug kbCollections kbQuery kbReport kbsmsAdmin
Last Modified: 02-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server version 2.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you run the following queries in Microsoft Systems Management Server (SMS)
Administrator Console, you may not receive any results:

- All Systems with Hardware Inventory Collected

- All Systems with Microsoft Word 97

- All Systems with Specified Software File Name and File Size

- All Systems with Specified Software Product Name and Version

- All User Groups

- All Users

CAUSE
=====

This problem can occur because of the way security is implemented in Windows
Management Instrumentation (WMI) and Web-Based Enterprise Management (WBEM).

Some of the queries that are included with SMS 2.0 do not return results unless
class rights to collections are granted. Other queries may work regardless of
collection rights.

The queries return results for users that have Read and Read Resource class
security rights to Collections\All Instances. However, if instance security
rights have been granted to some or all collections, the queries do not return
any results. Other queries can display results regardless of collection rights,
even if users have no rights to any collections (class or instance).

WORKAROUND
==========

To work around this problem, limit the query to a collection, and then give
users Read and Read Resource instance security rights on that collection.

NOTE: If you do not want to limit the query to a specific collection, another
option is to grant users Read and Read Resource class security rights to the
entire collection class.

STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
version 2.0 Service Pack 1 and SMS 2.0 Service Pack 2.


MORE INFORMATION
================

Computers that have been upgraded to Windows Management Instrumentation (WMI)
1.5 or Microsoft Windows 2000-based computers do not have the WMI 1.1 tool
(Wbemperm.exe).

NOTE: Windows NT 4.0 users which have WMI 1.5 installed, also need to install the
Microsoft Security Configuration Editor (SCE), included on the Windows NT 4.0
Service Pack 4 (SP4) (and later) CD-ROM. On Windows NT-based computers, the tool
is Wbemcntl.exe. The Microsoft SCE is required to edit the Access Control Lists
(ACLs) on the Windows Installer (WI) namespaces.


Additional query words: prodsms blank empty

======================================================================
Keywords          : kbMMC kbSecurity kbWBEM kbsms200 kbsms200bug kbCollections kbQuery kbReport kbsmsAdmin 
Technology        : kbSMSSearch kbSMS200
Version           : :2.0
Issue type        : kbbug
Solution Type     : kbnofix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>