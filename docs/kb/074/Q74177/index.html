<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q74177: Troubleshooting Problems with MS-DOS Shell | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q74177: Troubleshooting Problems with MS-DOS Shell" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/074/Q74177/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/074/Q74177/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/074/Q74177/","headline":"Q74177: Troubleshooting Problems with MS-DOS Shell","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q74177-troubleshooting-problems-with-ms-dos-shell">Q74177: Troubleshooting Problems with MS-DOS Shell</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q74177
Product(s): Microsoft Disk Operating System
Version(s): MS-DOS:5.x,6.0,6.2,6.21,6.22
Operating System(s): 
Keyword(s): 
Last Modified: 17-DEC-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft MS-DOS operating system versions 5.0, 5.0a, 6.0, 6.2, 6.21, 6.22 
-------------------------------------------------------------------------------

SYMPTOMS
========


You may experience the following problems when running the MS-DOS Shell under
MS-DOS version 5.0 or versions 6.0 and later:

- Shell stops responding (hangs) at startup or after the first screen.

- Various Shell display problems, such as compressed screen fonts and no color
  display, may occur.

MORE INFORMATION
================

When trouble-shooting these problems, consider the following:

1. Determine if an incorrect or old version of the mouse driver, or the wrong
  device driver, is installed in CONFIG.SYS and/or in AUTOEXEC.BAT. An older
  mouse driver may cause video disruption even though the mouse functions
  normally.

2. Try to run Shell with one of the following switches:

     dosshell /b   (to start Shell in black and white color)

  -or-

     dosshell /t   (to start Shell in text mode)

3. Rename DOSSHELL.VID.

  Run Shell without DOSSHELL.VID in text mode. If this works, the video driver
  must be changed by expanding another file from the original disks.

  For more information on the Shell video driver, query on the following words:

  " 5.0 and video and Shell " (without the quotation marks)

4. Check the DOSSHELL.GRB file. If you have a video problem while running Task
  Swapper, most likely the .GRB file is corrupted or not installed properly.
  The .GRB file is responsible for retaining the video display during the
  swapping (that is, it grabs the video display for a later display).

  If you encounter a problem with task switching graphic applications, make sure
  graphics mode is selected instead of text mode in the advanced section of the
  application properties. For example, Microsoft Word 5.5, when running in
  graphics mode, requires that Video Mode - Graphics be selected in the
  advanced section of the Program Item Properties dialog box.

5. Remove any terminate-and-stay-resident (TSR) programs or other drivers in the
  CONFIG.SYS and/or AUTOEXEC.BAT files, then rerun Shell.

6. Make sure DOSSHELL and corresponding video drivers run from the workstation
  if you are connected to a network. Run Shell from the DOS directory. Check to
  make sure "VIDEODIR=[DRIVE:][PATH]" in the DOSSHELL.INI has the proper
  location of the video drivers.

7. For testing purposes, do not load device drivers high. Change any DEVICEHIGH
  in CONFIG.SYS to read DEVICE and remove the LOADHIGH or LH statement in
  AUTOEXEC.BAT.

8. If you get the message

  Unable to load MS-DOS Shell, retry (y/n)?

  check whether DOSSHELL.EXE is in the DOS directory. If it is, it is possible
  that DOSSHELL.EXE has been corrupted. You need to expand the DOSSHELL.EXE
  from disk 3 (5.25-inch disks) or disk 2 (3.5-inch disks) of the Microsoft
  MS-DOS 5 Upgrade.

REFERENCES
==========

"Getting Started with MS-DOS" manual for version 5.0, page 52, 130

Additional query words: tshoot 5.00 5.00a 6.00 6.20 6.21, 6.22

======================================================================
Keywords          :  
Technology        : kbMSDOSSearch kbMSDOS621 kbMSDOS622 kbMSDOS620 kbMSDOS600 kbMSDOS500 kbMSDOS500a
Version           : MS-DOS:5.x,6.0,6.2,6.21,6.22

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>