<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q153246: Sms.exe Fails to Start When Attaching Sites | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q153246: Sms.exe Fails to Start When Attaching Sites" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/153/Q153246/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/153/Q153246/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/153/Q153246/","headline":"Q153246: Sms.exe Fails to Start When Attaching Sites","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q153246-smsexe-fails-to-start-when-attaching-sites">Q153246: Sms.exe Fails to Start When Attaching Sites</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q153246
Product(s): Microsoft Systems Management Server
Version(s): 1.0,1.1,1.2
Operating System(s): 
Keyword(s): kbsetup kbDespooler smsdespooler smssetup smsgeneral kbArtTypeINF
Last Modified: 13-FEB-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server versions 1.0, 1.1, 1.2 
-------------------------------------------------------------------------------


SYMPTOMS
========

SMS.EXE will fail to launch when Despooler fails to read "mini job to transfer
inventory info" sent from the primary site before the central site's inventory
information has been loaded into the central site's database.


MORE INFORMATION
================

After the Despooler fails on the "mini job to transfer inventory info," SMS.EXE
will fail to launch when accessing the central site database even though
accessing the primary site database is successful. The central site will be
rendered unusable when an attempt to attach to the central site is performed
before the central site has the chance to inventory and update its own inventory
information.

Example DESPOOLER.LOG:

  ~Executing instruction of type MICROSOFT|SMS|MINIJOBINSTRUCTION|INVENTORY
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:45 1995~&gt;&lt;thread=E0&gt;
   ** Beginning INVENTORY UPDATE procedure on parent site...~
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:45 1995~&gt;&lt;thread=E0&gt;
  Dataloader inbox = \\HASHSEC\SMS_SHRF\site.srv\dataload.box\deltamif.col~
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:45 1995~&gt;&lt;thread=E0&gt;
  got access to SQL Server~   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:45
  1995~&gt;&lt;thread=E0&gt;
  Successfully loaded Site information.   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04
  15:41:45 1995~&gt;&lt;thread=E0&gt;
  Loaded data dictionary   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:46
  1995~&gt;&lt;thread=E0&gt;
  Working on Identification   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:47
  1995~&gt;&lt;thread=E0&gt;
   Err&gt;General SQL Server error: Check messages from the SQL Server.~
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50 1995~&gt;&lt;thread=E0&gt;
   Err&gt;Attempt to initiate a new SQL Server operation with results pending.~
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50 1995~&gt;&lt;thread=E0&gt;
   Err&gt;General SQL Server error: Check messages from the SQL Server.~
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50 1995~&gt;&lt;thread=E0&gt;
   Msg&gt;Attempt to insert the value NULL into column 'NextMachineID', table
  'SMS.dbo.SMSData'; column does not allow nulls.  UPDATE fails.~
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50 1995~&gt;&lt;thread=E0&gt;
   Cmd&gt;drop table #MachineIDs    $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50
  1995~&gt;&lt;thread=E0&gt;
   Msg&gt;Command has been aborted.~   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50
  1995~&gt;&lt;thread=E0&gt;
   Cmd&gt;drop table #MachineIDs    $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50
  1995~&gt;&lt;thread=E0&gt;
   Msg&gt;DROP TABLE command not allowed within multi-statement transaction.~
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50 1995~&gt;&lt;thread=E0&gt;
   Cmd&gt;drop table #MachineIDs    $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50
  1995~&gt;&lt;thread=E0&gt;
   Err&gt;General SQL Server error: Check messages from the SQL Server.~
  $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50 1995~&gt;&lt;thread=E0&gt;
   Msg&gt;CREATE TRIGGER command not allowed within multi-statement
  transaction.~   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50 1995~&gt;&lt;thread=E0&gt;
   Cmd&gt; CREATE TRIGGER MachineDataTable_ins ON MachineDataTable FOR insert AS
  if (select distinct m.dwMachineID from Machines m, inserted i where
  m.dwMachineID = i.dwMachineID) = NULL      BEGIN        INSERT Machines
  (dwMachineID, ArchitectureKey) (selec   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04
  15:41:50 1995~&gt;&lt;thread=E0&gt;
   Cmd&gt;t distinct dwMachineID,         ArchitectureKey from inserted)
  END    $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50 1995~&gt;&lt;thread=E0&gt;
  Couldn't load all groups~   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50
  1995~&gt;&lt;thread=E0&gt;
  Logging an event for the error.~   $$&lt;SMS_DESPOOLER&gt;&lt;Mon Dec 04 15:41:50
  1995~&gt;&lt;thread=E0&gt;

STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
versions 1.0 and 1.1. This problem has been corrected in Systems Management
Server version 1.2.

Additional query words: prodsms 1.00 1.10

======================================================================
Keywords          : kbsetup kbDespooler smsdespooler smssetup smsgeneral kbArtTypeINF 
Technology        : kbSMSSearch kbSMS100 kbSMS110 kbSMS120
Version           : :1.0,1.1,1.2

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>