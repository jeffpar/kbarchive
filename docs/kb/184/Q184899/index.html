<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q184899: PRB: SelPrint Method Issues an EndDoc When Printing | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q184899: PRB: SelPrint Method Issues an EndDoc When Printing" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/184/Q184899/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/184/Q184899/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/184/Q184899/","headline":"Q184899: PRB: SelPrint Method Issues an EndDoc When Printing","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q184899-prb-selprint-method-issues-an-enddoc-when-printing">Q184899: PRB: SelPrint Method Issues an EndDoc When Printing</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q184899
Product(s): Microsoft Visual Basic for Windows
Version(s): 
Operating System(s): 
Keyword(s): kbCtrl kbVBp kbVBp600 kbGrpDSVB
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, version 6.0 
- Microsoft Visual Basic Professional Edition for Windows, version 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you use the SelPrint method in Visual Basic, you receive unexpected
results. If you execute an EndDoc method after a SelPrint, you may receive the
following error:

  Run-time Error #482:
  Printer Error

Additionally, if you are printing information after the SelPrint method within
the same print job, you may find that the information is not printed.

CAUSE
=====

The SelPrint method of the Rich TextBox control that ships with Visual Basic 6.0
has an optional second argument. This argument determines whether the SelPrint
method performs the StartDoc and EndDoc printer control operations, and sends
data to the printer using only EndPage and StartPage operations as required. If
you set this second argument to TRUE (or omit it), the SelPrint method performs
the StartDoc and EndDoc operations. If you set this second argument to FALSE,
the SelPrint method does not perform the StartDoc and EndDoc operations.

RESOLUTION
==========

There are two solutions to this problem:

- If you are not printing any information before or after the SelPrint method
  executes, do not use the EndDoc method and either omit the second argument of
  SelPrint or set it to True.

- If you want to print additional information after the SelPrint method
  executes, set the second argument of SelPrint to False so that SelPrint does
  not issue an EndDoc before your print job completes.

STATUS
======

This behavior is by design.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Start a new project in Visual Basic.

2. On the Project menu, click Components, and check "Microsoft Rich TextBox
  Control 6.0."

3. Add a RichTextbox control to Form1.

4. Add the following code to the Click event of Form1:

        Printer.Print " "
        Printer.Print "Hello"
        RichTextBox1.SelPrint Printer.hDC
        Printer.Print "Bye"
        Printer.EndDoc

5. Press F5 to run the project and then Form1.

RESULTS: You receive the run-time error 482. Additionally, you may notice that
anything printed after the SelPrint method ("Bye" in this case) is not included
in the output as expected.

Additional query words: kbVBp600 kbVBp kbdsd kbDSupport kbPrinting

======================================================================
Keywords          : kbCtrl kbVBp kbVBp600 kbGrpDSVB 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB600Search kbVBA600 kbVB600
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>