<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q31157: Use PRINT# to MS-DOS &quot;CON&quot; Device to Send ANSI Escape Codes | KnowledgeBase Archive</title>
<meta property="og:title" content="Q31157: Use PRINT# to MS-DOS &quot;CON&quot; Device to Send ANSI Escape Codes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/031/Q31157/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/031/Q31157/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/031/Q31157/","publisher":null,"image":null,"headline":"Q31157: Use PRINT# to MS-DOS &quot;CON&quot; Device to Send ANSI Escape Codes","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q31157-use-print-to-ms-dos-con-device-to-send-ansi-escape-codes">Q31157: Use PRINT# to MS-DOS "CON" Device to Send ANSI Escape Codes</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q31157
Product(s): See article
Version(s): 1.00 1.01 1.02 2.00 2.01 3.00 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | B_BasicCom B_GWBasicI | mspl13_basic
Last Modified: 22-JAN-1990

Sending ANSI escape codes to the screen with the PRINT statement will
not perform ANSI screen control because the PRINT statement (in the
products below) circumvents DOS and its device drivers.

To make ANSI escape sequences work properly, you must OPEN the DOS
"CON" or "CONS:" (console) device instead, and use PRINT# for output.

This information applies to the following products:

1. QuickBASIC Versions 1.00, 1.01, 1.02, 2.00, 2.01, 3.00, 4.00,
   4.00b, and 4.50 for IBM Personal Computers and Compatibles

2. Microsoft BASIC Compiler Version 6.00 and 6.00b for MS-DOS

3. Microsoft BASIC PDS Version 7.00 for MS-DOS and MS OS/2

4. GW-BASIC Versions 3.20, 3.21, 3.22, 3.23

5. IBM and Compaq versions of BASICA

To make ANSI control characters work properly, do the following:

1. Obtain the file ANSI.SYS from the DOS release disk. Put it on the
   root directory of your boot disk.

2. Put the statement DEVICE=ANSI.SYS in the CONFIG.SYS file on the
   root directory of the boot disk.

3. Reboot. If the message "ANSI.SYS Not Found" displays, the ANSI
   control codes will not work.

4. In your BASIC program, OPEN the DOS "CON" (console) device for
   output as #n.

5. Use PRINT#n to send output to the DOS "CON" (console) device.

6. CLOSE#n at the end of the program.

For a list of the ANSI escape sequences, refer to the following:

1. The "Microsoft MS-DOS Version 3.20 User's Reference," Appendix C
   "Installable Device Drivers"

2. IBM PC-DOS technical reference manual

The following code demonstrates how to use ANSI screen control codes
from BASIC:

'The following example changes the background
'and foreground color of the screen, sets blinking and bold characters,
'and positions the cursor:
CLS
escape$ = CHR$(27) + "["
attriboff$ = escape$ + "0m"
blinkon$ = "5m"
bold$ = "1m"
reversv$ = "7m"
red$ = "41m"
green$ = "42m"
blue$ = "44m"
blackback$ = "40m"
x = 30
y = 10
rowcol$ = MID$(STR$(y), 2) + ";" + MID$(STR$(x), 2) + "H"
OPEN "CON" FOR OUTPUT AS 1
PRINT #1, attriboff$;
PRINT #1, escape$ + rowcol$ + "Locate the cursor with ansi.sys"
PRINT #1, attriboff$;
PRINT #1, escape$ + blinkon$ + "Blinking" + attriboff$;
PRINT #1, escape$ + bold$ + "Bold" + attriboff$;
PRINT #1, escape$ + reversv$ + "reverse"
PRINT #1, escape$ + red$ + "red"
PRINT #1, escape$ + green$ + "green"
PRINT #1, escape$ + blue$ + "blue"
CLOSE #1
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>