<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q172192: PRB: Error: &quot;Failed to Get Expression Service&quot; | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q172192: PRB: Error: &quot;Failed to Get Expression Service&quot;" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/172/Q172192/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/172/Q172192/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/172/Q172192/","headline":"Q172192: PRB: Error: &quot;Failed to Get Expression Service&quot;","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q172192-prb-error-failed-to-get-expression-service">Q172192: PRB: Error: "Failed to Get Expression Service"</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q172192
Product(s): Open Database Connectivity (ODBC)
Version(s): WINDOWS:2.1x
Operating System(s): 
Keyword(s): kbenv kbinterop
Last Modified: 27-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Open Database Connectivity, version 2.1x 
-------------------------------------------------------------------------------

SYMPTOMS
========

Installation of ODBC 16-bit components with incompatible versions of OLE DLLs
causes the error "Failed to get expression service."

The installation of ODBC 2.1x SDK on a fresh installation of Windows 95 also
causes the error message described above.

The following table shows the difference in version numbers of the OLE DLLs that
cause this problem.

                              Version installed with
File name         Windows 95         Windows NT         ODBC 2.1x SDK
---------------------------------------------------------------------

Compobj.dll          2.2               2.1                  2.02
Ole2.dll             2.2               2.1                  2.02
Ole2conv.dll         2.01              2.1                  2.01
Ole2disp.dll         2.1               N/A                  2.02
Ole2nls.dll          2.1               2.1                  2.02
Stdole.tlb           2.1               2.1                  4.2kb (has no
                                                        internal version)
Storage.dll          2.2               2.1                  2.02
Typelib.dll          2.1               2.1                  2.02

Because the files that come with the ODBC 2.1x SDK are older(16-bit) than the
ones that come with Windows 95, these files are not overwritten.

WORKAROUND
==========

To work around this problem on a computer running Windows 95, delete the
existing files mentioned above in the &lt;Windows 95 root&gt;/System directory
and reinstall the ODBC 2.1x SDK. Make sure that the files have the correct
version numbers after the ODBC 2.1x SDK reinstallation.

MORE INFORMATION
================

On computers running Windows NT 4.0, this does not cause a problem because the
versions of the above files later than 2.02 are the 16/32 interoperability OLE
DLLs (32-bit), and are installed in the &lt;Windows NT root&gt;/System32
directory. A fresh installation of the 16-bit ODBC components from the ODBC 2.1x
SDK are installed into the &lt;Windows NT root&gt;/System directory.

Additional query words: odbc2.1x

======================================================================
Keywords          : kbenv kbinterop 
Technology        : kbAudDeveloper kbODBCSearch
Version           : WINDOWS:2.1x
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>