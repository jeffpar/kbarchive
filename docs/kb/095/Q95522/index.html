<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q95522: PC MAPI: Simple MAPI Version 3.2.0.4081 Update | KnowledgeBase Archive</title>
<meta property="og:title" content="Q95522: PC MAPI: Simple MAPI Version 3.2.0.4081 Update" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/095/Q95522/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/095/Q95522/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/095/Q95522/","publisher":null,"image":null,"headline":"Q95522: PC MAPI: Simple MAPI Version 3.2.0.4081 Update","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q95522-pc-mapi-simple-mapi-version-3204081-update">Q95522: PC MAPI: Simple MAPI Version 3.2.0.4081 Update</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q95522
Product(s): Microsoft Mail For PC Networks
Version(s): WINDOWS:3.0b,3.2
Operating System(s): 
Keyword(s): kbgraphxlinkcritical
Last Modified: 21-DEC-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail for Windows, versions 3.0b, 3.2 
-------------------------------------------------------------------------------

SUMMARY
=======

Microsoft provides replacements for the Simple MAPI files, included with
versions 3.0b and 3.2 of Microsoft Mail for PC Networks, for both Microsoft C
and Microsoft Visual Basic. The replacement files provide additional
enhancements to the original Mail technical reference disk.

For complete information about obtaining and installing the Simple MAPI files,
see the following sections:

- To download the updated files

- To update your technical reference disk

- To use the technical reference manual files

- To update your MAPI.DLL and FRAMEWORK.DLL files

- To use the Autosend application or source code

MORE INFORMATION
================

This update includes the following files:

 Filename      | Description
----------------------------------------------------------------------
 TECHDISK.EXE  | Mail technical reference disk
 TECHDOCS.EXE  | Mail technical reference manual
 MAPI.DLL      | Messaging Application Programming Interface (MAPI)
               | dynamic link library
 FRAMEWRK.DLL  | Framework layer dynamic link library
 SAMPLE.EXE    | Sample Simple MAPI application for sending mail
               | automatically. Source files included.

The Simple MAPI files included on the technical reference disk allow application
developers to include messaging capabilities in their applications' user
interfaces. Support is provided for both Microsoft C and Microsoft Visual
Basic.

This update contains TECHDISK.EXE, a replacement for the Mail technical reference
disk included with versions 3.0b and 3.2 of Microsoft Mail for Windows. This
replacement disk provides additional enhancements to the original Mail technical
reference disk and includes the following modifications for versions 3.0b and
3.2 of Microsoft Mail for Windows:

- MAPI.H has been modified to be strictly ANSI compatible, and no longer causes
  warnings on Warning Level 4 with the Microsoft C version 7.0 compiler.

- The sample Visual Basic Simple MAPI application has been modified to compile
  when you use Microsoft Visual Basic version 2.0.

This update also contains TECHDOCS.EXE, an electronic version of the Mail
technical reference manual included with version 3.2 of Microsoft Mail for
Windows.

This update also includes the latest MAPI.DLL and FRAMEWRK.DLL files, and a
sample Visual Basic program called Autosend (included in the SAMPLE.EXE file)
that sends mail at specific times or intervals. The code for this application is
included to allow additional capabilities such as checking mail response time
between postoffices.

This update also contains MAPI.DLL, a replacement for the MAPI.DLL file included
with versions 3.0b and 3.2 of Microsoft Mail for Windows. This replacement file
provides additional enhancements to the original MAPI.DLL file and resolves the
following problems that can occur when you are using versions 3.0b and 3.2 of
Microsoft Mail for Windows:

- Deleting a message in a shared folder does not function as expected; the
  message in the folder is deleted, but the header still appears. If you select
  the header to bring up the message, Mail for Windows returns a dialog box
  that says "The message cannot be accessed." Also, if you change a message in
  any way, the message becomes inaccessible.

- Reply, Reply All, and Forward commands on customer messages in shared folders
  fail if these commands are called from Mail for Windows. This problem occurs
  because the client hands off the temporary message ID of the shared folder,
  instead of the permanent shared-folder message ID. NOTE: For this problem to
  be resolved, two files must be updated: the MAPI.DLL file (included in this
  update) and the MSMAIL.EXE file (update included in MAILUPD.EXE on the MSL).

- To correctly launch e-forms, Microsoft Electronic Forms Designer requires
  that the message type it gives to Simple MAPI be preserved in the delivered
  message. However, the message type is not encoded in WINMAIL.DAT by default,
  so it is lost across gateways. Therefore, the message is received and
  displayed as a note rather than as a Microsoft electronic form.

- Custom forms that did not include their own textize maps could not use the
  provided default print/save functionality.

  NOTE: To fix this problem, MSSFS.DLL (update included in MSSFS.EXE on the MSL)
  version 3.2.4081 or later must be used in conjunction with the MAPI.DLL
  included in this update.


This update also contains FRAMEWRK.DLL, a replacement for the FRAMEWRK.DLL file
included with versions 3.0b and 3.2 of Microsoft Mail for Windows. This
replacement file resolves the following problem that can occur when you use
versions 3.0b and 3.2 of Microsoft Mail for Windows:

- When you execute the MAPIAddress() function, an "Out of Memory" error can
  occur. This problem occurs because a second MAPI session is being started and
  closed, and the MAPIAddress() function is then executed in the first session.

To Download the Updated Files
-----------------------------

The following file is available for download from the Microsoft Download Center:

  DownloadDownload Mapiupd.exe now
  (http://download.microsoft.com/download/mapi/Update/13/W9XNT4/EN-US/Mapiupd.exe)

For additional information about how to download Microsoft Support files, click
the article number below to view the article in the Microsoft Knowledge Base:

  Q119591 How to Obtain Microsoft Support Files from Online Services

Microsoft used the most current virus detection software available on the date of
posting to scan this file for viruses. Once posted, the file is housed on secure
servers that prevent any unauthorized changes to the file.


After you download MAPIUPD.EXE to a clean directory, run it (by typing "mapiupd"
(without the quotation marks) at the MS-DOS prompt) to extract the contents of
the file. You should receive the following files:

  MAPI.DLL     ( 54,208 bytes, dated 02/01/95, 2:31 A.M.)
  TECHDISK.EXE (216,727 bytes, dated 09/17/93, 8:00 A.M.)
  TECHDOCS.EXE (289,006 bytes, dated 09/17/93, 8:00 A.M.)
  FRAMEWRK.DLL (221,168 bytes, dated 05/06/93, 7:00 A.M.)
  SAMPLE.EXE   (334,884 bytes, dated 09/17/93, 8:00 A.M.)
  README.TXT

To update your technical reference disk
---------------------------------------

1. At the MS-DOS command prompt, type the following and press ENTER

  " copy &lt;drive&gt;:\techref\disk\techdisk.exe &lt;destination&gt;" (without
  the quotation marks)

  where &lt;drive&gt; the drive and directory where you ran the self-extracting
  MAPIUPD.EXE file and &lt;destination&gt; is the drive and directory where
  your Simple MAPI files currently reside. For example, if you ran the
  self-extracting file from the TEST directory on drive D, and your Simple MAPI
  files are located in the MAILEXE\TECHREF directory on drive C, type the
  following command:

  " copy d:\test\techdisk.exe c:\mailexe\techref" (without the quotation marks)

2. At the MS-DOS command prompt, type the following and press ENTER

  " &lt;destination&gt;\techdisk.exe -d" (without the quotation marks)

  where &lt;destination&gt; is the drive and directory where your Simple MAPI
  files currently reside. For example, if your Simple MAPI files are located in
  the MAILEXE\TECHREF directory on drive C, type the following command:

  " c:\mailexe\techref\techdisk.exe -d" (without the quotation marks)

3. At the MS-DOS command prompt, type the following and press ENTER

  " copy &lt;mailexe&gt;\setup.inf &lt;mailexe&gt;\setupinf.old" (without the
  quotation marks)

  where &lt;mailexe&gt; is the complete path to the directory containing the
  Microsoft Mail for Windows SETUP.EXE program. For example, if SETUP.EXE is
  located in the MAILEXE directory on drive C, type the following command:

  " copy c:\mailexe\setup.inf c:\mailexe\setupinf.old" (without the quotation
  marks)

4. Using any text editor, edit the SETUP.INF file. In the [MsMail System]
  section, replace the following line

  1, mapi.dll,,,, 1993-05-26, !DECOMPRESS,, OLDER, !READONLY ,,,,, SHARED,
  ,,,,, 54352,,,, 3.2.0.4037,

  with:

  " 1, mapi.dll,,,, 1995-02-01, !DECOMPRESS,, OLDER, !READONLY ,,,,, SHARED,
  54208,,,, 3.2.0.4081" (without the quotation marks)

  Save the file and close the text editor.

  NOTE: For these changes to affect the entire network, each existing user must
  run Setup again.

To use the technical reference manual files
-------------------------------------------

At the MS-DOS command prompt, type the following commands and press ENTER after
each line

  " md &lt;harddrive&gt;:\&lt;destination&gt;
  copy &lt;drive:&gt;\techref\doc\techdocs.exe &lt;destination&gt;
  &lt;destination&gt;:\techdocs.exe" (without the quotation marks)

where &lt;harddrive&gt; is the local hard disk or network drive, &lt;drive&gt; is
the drive and directory where you ran the self-extracting MAPIUPD.EXE file, and
&lt;destination&gt; is the path where you want the technical reference manual
files to reside. For example, if you ran the self-extracting file from the TEST
directory on drive D, and you want the files to reside in the C:\TECHDOCS
directory, type the following command:

  " md c:\techdocs
  copy d:\test\techdocs.exe c:\techdocs
  c:\techdocs\techdocs.exe" (without the quotation marks)

The technical reference manual files are in Word for Windows 2.0 format. Read the
README.TXT file in the directory where the technical reference files reside.

To update your MAPI.DLL and FRAMEWORK.DLL files
-----------------------------------------------

NOTE: To fix the problem with MAPI.DLL version 3.2.4081, you must do one of the
following steps:

- Recompile all user[ASCII 146]s custom-form generating applications supplying
  the custom form a new message class name.

-or-

- To replace the old textize map with a new one, you need to create a new mail
  message file (MMF) for every user.

At the MS-DOS command prompt, type the following and press ENTER

  " copy&lt; drive&gt;:\*.DLL&lt; destination&gt;" (without the quotation
  marks)

where &lt;drive&gt; is the drive and directory where you ran the self-extracting
MAPIUPD.EXE file and &lt;destination&gt; is the drive and directory where your
MAPI.DLL and FRAMEWRK.DLL files currently reside. For example, if you ran the
self-extracting file from the TEST directory on drive D, and your MAPI.DLL and
FRAMEWRK.DLL files are located in the MAILEXE directory on drive C, type the
following command:

  " copy d:\test\*.DLL c:\mailexe" (without the quotation marks)

To use the Autosend application or source code
----------------------------------------------

1. At the MS-DOS command prompt, type the following commands and press ENTER
  after each line

  " md &lt;harddrive&gt;:\&lt;destination&gt;
  copy &lt;drive&gt;:\sample\sample.exe &lt;destination&gt;
  &lt;destination&gt;:\sample.exe" (without the quotation marks)

  where &lt;harddrive&gt; is the local hard disk or network drive, &lt;drive&gt;
  is the drive and directory where you ran the self-extracting MAPIUPD.EXE
  file, and &lt;destination&gt; is the path where you want the sample
  application files to reside. For example, if you ran the self- extracting
  file from the TEST directory on drive D, if you want the files to reside in
  the C:\SAMPLE directory, type the following command:

  " md c:\sample
  copy d:\test\sample.exe c:\sample
  c:\sample\sample.exe" (without the quotation marks)

2. At the MS-DOS command prompt, type the following commands and press ENTER
  after each line to use the Autosend application

  " copy &lt;samplepath&gt;:\*.vbx c:\&lt;windir&gt;
  copy &lt;samplepath&gt;:\*.dll c:\&lt;windir&gt;\system" (without the
  quotation marks)

  where &lt;samplepath&gt; is the drive and directory where the sample
  application resides and &lt;windir&gt; is the path to the Windows directory.
  For example, if the sample application is in the C:\SAMPLE directory and your
  Windows directory is C:\WINDOWS, type the following commands:

  " copy c:\sample\*.vbx c:\windows
  copy c:\sample\*.dll c:\windows\system" (without the quotation marks)

  Run the sample application from Windows. To use the source code, you must use
  the Professional Edition of Microsoft Visual Basic version 2.0 or later.

Additional query words: 3.00b wga

======================================================================
Keywords          : kbgraphxlinkcritical 
Technology        : kbMailSearch kbZNotKeyword3 kbMail320 kbMail300b
Version           : WINDOWS:3.0b,3.2

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>