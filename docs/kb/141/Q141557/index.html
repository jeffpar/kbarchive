<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q141557: FIX: Cursor’s ReadOnly Property Carried to Other Data Sessions | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q141557: FIX: Cursor’s ReadOnly Property Carried to Other Data Sessions" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/141/Q141557/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/141/Q141557/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/141/Q141557/","headline":"Q141557: FIX: Cursor’s ReadOnly Property Carried to Other Data Sessions","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q141557-fix-cursors-readonly-property-carried-to-other-data-sessions">Q141557: FIX: Cursor’s ReadOnly Property Carried to Other Data Sessions</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q141557
Product(s): Microsoft FoxPro
Version(s): 3.00 3.00b
Operating System(s): 
Keyword(s): kbvfp kbvfp300bBUG kbvfp500fixkbbuglist kbfixlist
Last Modified: 24-MAR-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you use the same table in separate forms that have Private Data Sessions,
the ReadOnly property of a cursor is carried over from the first session.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. This problem has been fixed in Visual FoxPro 5.0
for Windows.

MORE INFORMATION
================

The following steps demonstrate the behavior. The behavior is specific to the
order in which you launch these forms. If you launch the ReadWrite form first,
issuing the APPEND BLANK command does in fact append a blank record to the table
and the record is visible in the grid on the ReadOnly form. On the other hand,
if you launch the ReadOnly form first, issuing the APPEND BLANK command causes
an error. Both these behaviors show that the Data Session is not truly private.

Steps to Reproduce Problem
--------------------------

1. Create a form and call it ReadWrite. Right-click the form, and select Data
  Environment. Then right-click the Data Environment window, and select Add.

2. Select a table and add it to the Data Environment. Then select the table in
  the Data Environment, and change its ReadOnly property to false (.F.) in the
  Property Sheet.

3. Select the form and change its DataSession property to 2 - Private Data
  Session.

4. Place a command button on the form, and change its Caption property to
  Append. Then add the following code to its Valid event:

     APPEND BLANK

5. Create a second form, and name it ReadOnly. Right-click the new form, and
  select Data Environment. Then right-click the Data Environment window and
  select Add. Select the same table selected in step 2 and add it to the Data
  Environment.

6. Select the table in the Data Environment and change its ReadOnly property to
  true (.T.) in the Property Sheet. Select the form and change its DataSession
  property to 2 - Private Data Session. Drag the table from the Data
  Environment to the ReadWrite form to create s grid.

7. Run the ReadWrite form. Then run the ReadOnly form. Click the Append button
  in the ReadWrite form. Then click the first blank record in the grid on the
  ReadOnly form. Note that although you can click into the new record and see
  the caret blinking there, you cannot enter data into the blank record.

8. Close both forms. With the USE command, open the table and delete the added
  record. Then pack the table.

9. Run the ReadOnly form. Then run the ReadWrite form. Note that you reversed
  the order in which the forms were launched. Click the Append button in the
  ReadWrite form. Note that the Trace window appears with the Valid code of the
  command button exposed highlighting the line of code that states:

     APPEND BLANK

  Also, an error occurs that states:

  Cannot update cursor.

  After you click Ignore, note that the grid does not have a blank record.

Additional query words:

======================================================================
Keywords          : kbvfp kbvfp300bBUG kbvfp500fix kbbuglist kbfixlist
Technology        : kbVFPsearch kbAudDeveloper kbVFP300 kbVFP300b
Version           : 3.00 3.00b
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>