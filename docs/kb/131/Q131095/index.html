<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q131095: How to Control the Occurrence of a Default Event | KnowledgeBase Archive</title>
<meta property="og:title" content="Q131095: How to Control the Occurrence of a Default Event" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/131/Q131095/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/131/Q131095/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/131/Q131095/","publisher":null,"image":null,"headline":"Q131095: How to Control the Occurrence of a Default Event","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q131095-how-to-control-the-occurrence-of-a-default-event">Q131095: How to Control the Occurrence of a Default Event</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q131095
Product(s): Microsoft FoxPro
Version(s): 3.00
Operating System(s): 
Keyword(s): kbcode
Last Modified: 26-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SUMMARY
=======

An event is an action generated by a user, a program, or the system. When an
event is triggered, Visual FoxPro processes some default system tasks. For
example, pressing a key triggers the keypress event that causes the letter to be
displayed in a text box. With Visual FoxPro, you can control the occurrence of
system events. This article describes how to prevent system processing of
events, and how to cause default events to occur before user-generated or
code-generated events occur.

You can add code to a method to customize operations that occur when an event is
triggered. When an event handler is customized, system processing occurs in
addition to the tasks defined in user code. By default, the user code is
processed first followed by system processing.

MORE INFORMATION
================

Preventing System Processing from Occurring
-------------------------------------------

Use the NODEFAULT keyword in method code to prevent system processing of events.
For example, in an input field, you can prevent some characters from being
displayed by using the NODEFAULT clause in a Keypress event handler. The default
behavior when a key is pressed is to display the character being typed. The
NODEFAULT keyword is used in the MAIN form of the CONTROLS project located in
the SAMPLES\CONTROLS directory.

For more information about NODEFAULT, search for DEFINE CLASS in the Visual
FoxPro Help menu.

Forcing System Processing to Occur Before User-Defined Code Is Processed
------------------------------------------------------------------------

You can cause the system code for the event to be processed first - before the
user-defined code is prcessed. This is useful, for example, if you want to
control the starting position of a text selection when the control gets the
focus. Default processing of the GotFocus event causes the SelStart property to
be set to zero (0), and the insertion point (cursor) is positioned before the
first character displayed in the control.

You can't just set the value of the SelStart property in the GotFocus event
because the GotFocus default processing occurs after user code is processed, so
the SelStart property is reset to zero (0). The default processing of the
GotFocus event must occur before the value of the SelStart property is
customized.

To make the default processing occur first, you need to modify the GotFocus event
code in the GotFocus event handler to follow this sequence:

1. Call the base class GotFocus event.

2. Set the SelStart property in the GotFocus event code of the text box.

3. Place the NODEFAULT clause, which stops the default processing of GotFocus
  from occurring again after your code.

The following example code demonstrates this method.

Sample Code to Place in the GotFocus Method of a Text Box Control
-----------------------------------------------------------------

  * First, force default processing:
  Textbox::GotFocus()

  * Set the SelStart property:
  This.SelStart = 4

  * Default processing already occurred, so prevent it from occurring again:
  NODEFAULT

Additional query words: VFoxWin form selection

======================================================================
Keywords          : kbcode 
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : 3.00

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>