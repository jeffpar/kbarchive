<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q21963: ENVIRON Statement Produces &quot;Out of Memory&quot; Error Message | KnowledgeBase Archive</title>
<meta property="og:title" content="Q21963: ENVIRON Statement Produces &quot;Out of Memory&quot; Error Message" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/021/Q21963/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/021/Q21963/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/021/Q21963/","publisher":null,"image":null,"headline":"Q21963: ENVIRON Statement Produces &quot;Out of Memory&quot; Error Message","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q21963-environ-statement-produces-out-of-memory-error-message">Q21963: ENVIRON Statement Produces "Out of Memory" Error Message</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q21963
Product(s): See article
Version(s): 2.00 2.01 3.00 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | b_basiccom | mspl13_basic
Last Modified: 29-APR-1990

Most forms of the ENVIRON statement produce the run-time error message
"Out of memory" (on DOS Versions 2.x through 3.30). The following
example produces the "Out of memory" error message:

   ENVIRON "PATH=C:\COBOL"

The following example usually works correctly, however, the ENVIRON
statement is not very practical in QuickBASIC:

   ENVIRON "PATH=;"

Expanding the environment table cannot be done in a QuickBASIC program
because the size of the environment table is limited to its size
rounded up to the nearest multiple of 16 bytes, when QuickBASIC or a
QuickBASIC program is initiated.

QuickBASIC does not modify the actual DOS environment table; it only
modifies a local copy.

You can work around this problem by doing the following:

1. SET a large string in the MS-DOS environment table before running
   QB.EXE or a compiled program, as in the following example:

   SET JUNK=123456789012345678901234567890

2. Use the following ENVIRON statements in your program to set the
   large string equal to a null string, then you can allocate strings
   whose length totals up to the size that was deallocated:

   PRINT ENVIRON$("JUNK")  ' DOS environment variables MUST be
                           ' uppercase.

ENVIRON "JUNK=;"           ' This deallocates environment table
                           ' space.

PRINT ENVIRON$("JUNK")     ' This confirms deallocation; prints
                           ' nothing.

ENVIRON "TEST=C:\COBOL"    ' This sets up new environment string.

PRINT ENVIRON$("TEST")     ' This displays the new environment
                           ' string.

   Note that the MS-DOS environment variable names must be uppercase.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>