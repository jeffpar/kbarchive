<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q129837: Nested OLE Objects Are Destroyed When Parents Are Destroyed | KnowledgeBase Archive</title>
<meta property="og:title" content="Q129837: Nested OLE Objects Are Destroyed When Parents Are Destroyed" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/129/Q129837/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/129/Q129837/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/129/Q129837/","publisher":null,"image":null,"headline":"Q129837: Nested OLE Objects Are Destroyed When Parents Are Destroyed","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q129837-nested-ole-objects-are-destroyed-when-parents-are-destroyed">Q129837: Nested OLE Objects Are Destroyed When Parents Are Destroyed</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q129837
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:4.0
Operating System(s): 
Keyword(s): 
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

When you have OLE objects that create OLE objects, these nested objects are
destroyed (set equal to Nothing) when the parent object that created them is
destroyed.

MORE INFORMATION
================

Visual Basic releases all second-level objects (objects created by objects) when
the top level class is destroyed. This is essentially the same behavior as an
object variable going out of scope.

For example, assume the following object hierarchy:

Two classes:

     Class CTopLevel
     Class CSecondLevel

Class CTopLevel has the object members.

     Public ChildObject As CSecondLevel
     Public ParentString As String

Class CSecondLevel has the object member.

     Public ChildString As String

In the Initialize event of CTopLevel, you set the ChildObject:

     Private Sub CTopLevel_Initialize ()
        Set ChildObject = New CSecondLevel
        ChildObject.ChildString = "I'm a child object."
     End Sub

If the CTopLevel class is created and goes out of scope after the End Sub in the
following code:

     Private Sub Form_Click ()
        Dim ParentObject As New CTopLevel
        ParentObject.ParentString = "I'm a parent object."
     End Sub

a CSecondLevel object (ChildObject) is explicitly instantiated in the
CTopLevel_Initialize event, but implicitly destroyed when ParentObject goes out
of scope at the end of the Form_Click Sub procedure.

For objects that have not been destroyed when a Visual Basic application shuts
down, Visual Basic does a two-pass cleanup on outstanding objects. Pass one
releases all module level and static object references (classes and objects).
Pass two releases the objects themselves. This allows parent and child objects
to both shut down even though they may have module-level references to each
other. Essentially, Visual Basic cleans up after itself very well.

Additional query words: 4.00 vb4win vb4all

======================================================================
Keywords          :  
Technology        : kbVBSearch kbAudDeveloper kbVB400Search kbVB400 kbVB16bitSearch
Version           : WINDOWS:4.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>