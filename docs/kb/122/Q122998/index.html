<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q122998: PC MAPI: Visual Basic Example for C Code in Tech Reference | KnowledgeBase Archive</title>
<meta property="og:title" content="Q122998: PC MAPI: Visual Basic Example for C Code in Tech Reference" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/122/Q122998/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/122/Q122998/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/122/Q122998/","publisher":null,"image":null,"headline":"Q122998: PC MAPI: Visual Basic Example for C Code in Tech Reference","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q122998-pc-mapi-visual-basic-example-for-c-code-in-tech-reference">Q122998: PC MAPI: Visual Basic Example for C Code in Tech Reference</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q122998
Product(s): Microsoft Mail For PC Networks
Version(s): WINDOWS:3.0,3.2
Operating System(s): 
Keyword(s): 
Last Modified: 27-OCT-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail for PC Networks, versions 3.0, 3.2 
-------------------------------------------------------------------------------

SUMMARY
=======

The Microsoft Mail for PC Networks "Technical Reference" includes a Microsoft C
programming language source code example for sending a mail message and
attachment using MAPI. However, no such code is provided for Visual Basic.

MORE INFORMATION
================

The following code is the Visual Basic equivalent of the C code example found in
the Technical Reference guide.

  ' ***************************************************
  ' Visual Basic equivalent of the C programming language
  ' sample found in the Microsoft Mail Technical Reference
  ' ***************************************************
  Dim M As MapiMessage
  Dim Mo As MapiRecip
  ReDim R(0 To 1) As MapiRecip
  ReDim F(0 To 0) As MapiFile
  NL = Chr(10)

  F(0).Reserved = 0&amp;
  F(0).Flags = 0&amp;
  F(0).Position = -1
  F(0).PathName = "C:\budget17.wk3"
  F(0).FileName = "budget17.wk3"
  F(0).FileType = ""

  Msg1$ = "Attached is the budget proposal. "
  Msg2$ = "See you Monday."

  M.Subject = Msg1$ + Msg2$
  M.MessageType = ""
  M.RecipCount = 2
  M.FileCount = 1

  R(0).Reserved = 0&amp;
  R(0).RecipClass = MAPI_To
  R(0).Name = "Sally Jones"
  R(0).EIDSize = 0&amp;
  R(0).EntryID = ""

  R(1).Reserved = 0&amp;
  R(1).RecipClass = MAPI_To
  R(1).Name = "Marketing"
  R(1).EIDSize = 0&amp;
  R(1).EntryID = ""

  rc&amp; = MAPILogon(0&amp;, "admin", "password", 0&amp;, 0&amp;, lhSession&amp;)

  rc&amp; = MAPISendMail(0&amp;, 0&amp;, M, R(0), F(0), 0&amp;, 0&amp;)
  If rc&amp; &lt;&gt; SUCCESS_SUCCESS Then MsgBox "Unable to send the message."

  rc&amp; = MAPILogoff(lhSession&amp;, 0&amp;, 0&amp;, 0&amp;)
  End
  ' ****************************
  ' End of source code
  ' ****************************

To get the code to work, MAPILogon and MAPILogoff function calls have been
included in the source code.

Additional query words:

======================================================================
Keywords          :  
Technology        : kbMailSearch kbZNotKeyword3 kbMailPCN320 kbMailPCN300
Version           : WINDOWS:3.0,3.2

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>