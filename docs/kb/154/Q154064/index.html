<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q154064: How To Direct Output to Installed GX Printers | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q154064: How To Direct Output to Installed GX Printers" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/154/Q154064/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/154/Q154064/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/154/Q154064/","headline":"Q154064: How To Direct Output to Installed GX Printers","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q154064-how-to-direct-output-to-installed-gx-printers">Q154064: How To Direct Output to Installed GX Printers</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q154064
Product(s): Microsoft FoxPro
Version(s): MACINTOSH:3.0b
Operating System(s): 
Keyword(s): kb3rdparty
Last Modified: 14-DEC-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Macintosh, version 3.0b 
-------------------------------------------------------------------------------

SUMMARY
=======

Controlling what printer a program prints to can be accomplished through code
with the enhancements to the SET PRINTER TO command in Visual FoxPro run with
QuickDraw GX and some other new functions. This article provides a sample
program combining the SYS(1038), the JustCSName() and the SET PRINTER TO NAME
enhancements to illustrate how to control which printer a report is printed to.

NOTE: QuickDraw GX is manufactured by a vendor independent of Microsoft; we make
no warranty, implied or otherwise, regarding the performance or reliability of
QuickDraw GX.

QuickDraw GX is not supported in Macintosh OS 8 and this sample program will not
work with Visual FoxPro running under OS 8.

MORE INFORMATION
================

Sample Program
--------------

The following sample program assumes that QuickDraw GX is installed, that at
least two printers are set up, and that their icons are on the desktop:

     *** Beginning of sample program
     IF SYS(1038)
     desktop=SUBSTR(SYS(2033),1,AT(':',SYS(2033)))+"\Desktop Folder\"
     numPrinters=ADIR(prtList, desktop+"*.*",'','dvcf')
     SET LIBRARY TO HOME()+"FoxTools.cfm" ADDITIVE
     FOR x=1 TO numPrinters
      SET PRINTER TO NAME JustCSName(desktop+prtList[(x),1])
        REPORT FORM "somereport.frx" NOEJECT NOCONSOLE TO PRINTER
        ? SET("Printer",2)
     ENDFOR
     SET LIBRARY TO
     ENDIF
     *** End of sample program

Program Commentary
------------------

The first line in the program checks to see if QuickDraw GX is installed by using
the SYS(1038) function.

The second line determines the name of the Macintosh's hard drive by using the
SYS(2033) function, and appends "Desktop Folder" to it.

The third line checks to see how many QuickDraw GX printer icons are on the
desktop and stores their names in an array named "prtList". The 'dvcf' in the
fourth argument of the ADIR() function is the creator type of the QuickDraw GX
printer icons.

The fourth line loads the FoxTools.cfm library, which is necessary for the use of
the JustCSName function.

The fifth line is the beginning of a FOR loop that executes once for each
QuickDraw GX printer icon found on the desktop.

The sixth line (the first one in the FOR loop) sets the printer to one of the
QuickDraw GX printers found on the desktop.

The seventh line prints a predefined report.

The eighth line reports the name of the current QuickDraw GX printer to the
current output device (the Visual FoxPro screen).

REFERENCES
==========

For additional information, please see the following articles in the Microsoft
Knowledge Base:

  Q152396 How To Determine if QuickDraw GX Is Loaded Using SYS Function

  Q153155 How To Use New Undocumented Foxtools Function JustCSName()

  Q153528 SET PRINTER TO Enhancements in Visual FoxPro for Macintosh

Additional query words: VFoxMac

======================================================================
Keywords          : kb3rdparty 
Technology        : kbHWMAC kbOSMAC kbVFPsearch kbAudDeveloper kbVFP300bMac
Version           : MACINTOSH:3.0b

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>