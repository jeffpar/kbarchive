<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q154482: FIX: Undocumented Functions in Type Safe Collection Classes | KnowledgeBase Archive</title>
<meta property="og:title" content="Q154482: FIX: Undocumented Functions in Type Safe Collection Classes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/154/Q154482/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/154/Q154482/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/154/Q154482/","publisher":null,"image":null,"headline":"Q154482: FIX: Undocumented Functions in Type Safe Collection Classes","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q154482-fix-undocumented-functions-in-type-safe-collection-classes">Q154482: FIX: Undocumented Functions in Type Safe Collection Classes</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q154482
Product(s): Microsoft C Compiler
Version(s): winnt:4.2
Operating System(s): 
Keyword(s): kbnokeyword kbMFC kbDocs kbVC420bug kbVC500fix kbGrpDSMFCATL kbNoUpdate
Last Modified: 06-MAY-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- The Microsoft Foundation Classes (MFC), used with:
   - Microsoft Visual C++, 32-bit Enterprise Edition, version 4.2 
   - Microsoft Visual C++, 32-bit Professional Edition, version 4.2 
-------------------------------------------------------------------------------

SYMPTOMS
========

MFC 4.2 in Visual C++ 4.2 added some additional wrapper functions for the
template type safe collection classes, such as CTypedPtrList, CTypedPtrArray and
CTypedPtrMap. The newly-added functions help to make these classes fully type
safe to use. However, the added functions are not documented in the Visual C++
Online Documentation.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. This problem was fixed in Visual C++ version 5.0.

MORE INFORMATION
================

Following is a full list of the functions added to the template type safe
collection classes:

CTypedPtrList
-------------

     template&lt;class BASE_CLASS, class TYPE&gt;
     class CTypedPtrList : public BASE_CLASS

           // Add a new element before head or after tail of the list
           POSITION AddHead( TYPE newElement );
           POSITION AddTail( TYPE newElement );

           // Add another list of elements before head or after tail
           void AddHead( CTypedPtrList&lt;BASE_CLASS,TYPE&gt; *pNewList );
           void AddTail( CTypedPtrList&lt;BASE_CLASS,TYPE&gt; *pNewList );

           // Modify an element at a given position
           void SetAt( POSITION pos, TYPE newElement );

CTypedPtrArray
--------------

     template&lt;class BASE_CLASS, class TYPE&gt;
     class CTypedPtrArray : public BASE_CLASS

           // Set the array element at the specified index
           void SetAt( int nIndex, TYPE ptr );

           // Potentially growing the array
           void SetAtGrow( int nIndex, TYPE newElement );
           int Add( TYPE newElement );
           int Append( const CTypedPtrArray&lt;BASE_CLASS, TYPE&gt;&amp; src );
           void copy( const CTypedPtrArray&lt;BASE_CLASS, TYPE&gt;&amp; src );

           // Operations that move elements around
           void InsertAt( int nIndex, TYPE newElement, int nCount=1 );
           void InsertAt( int nStartIndex,
                          CTypedPtrArray&lt;BASE_CLASS, TYPE&gt;* pNewArray );

CTypedPtrMap
------------

     template&lt;class BASE_CLASS, class KEY, class VALUE&gt;
     class CTypedPtrMap : public BASE_CLASS

           // Add a new key (key,value) pair
           void SetAt( KEY key, VALUE newValue );

           // removing existing (key,?) pair
           BOOL RemoveKey( KEY key );

For detailed information about these functions, please refer to the corresponding
documentation for the functions in BASE_CLASS (the template parameter for each
of the above template classes). For instance, if you have
CTypedPtrMap&lt;CMap,MyKey,MyValue&gt;, then refer to the documentation for CMap
for the functions listed above under CTypedPtrMap.

You can also look at \msdev\mfc\include\afxtempl.h header file for the
implementation of these functions.

Additional query words: kbVC420bug

======================================================================
Keywords          : kbnokeyword kbMFC kbDocs kbVC420bug kbVC500fix kbGrpDSMFCATL kbNoUpdate 
Technology        : kbAudDeveloper kbMFC
Version           : winnt:4.2
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>