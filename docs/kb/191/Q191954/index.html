<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q191954: PRB: OLE DLL with Exposed Objects Returns Incorrect Description | KnowledgeBase Archive</title>
<meta property="og:title" content="Q191954: PRB: OLE DLL with Exposed Objects Returns Incorrect Description" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/191/Q191954/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/191/Q191954/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/191/Q191954/","publisher":null,"image":null,"headline":"Q191954: PRB: OLE DLL with Exposed Objects Returns Incorrect Description","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q191954-prb-ole-dll-with-exposed-objects-returns-incorrect-description">Q191954: PRB: OLE DLL with Exposed Objects Returns Incorrect Description</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q191954
Product(s): Microsoft FoxPro
Version(s): WINDOWS:6.0
Operating System(s): 
Keyword(s): 
Last Modified: 20-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

Under certain circumstances, an OLE .dll with two exposed objects can return the
wrong class description in an error message.

CAUSE
=====

The error routine for a User Interface error in a Visual FoxPro .dll always
takes the class description from the first class.

STATUS
======

Microsoft is researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Create a new project called OLETest1.

2. Place the following code into a program file called Test1.prg:

        DEFINE CLASS ErrTest1 AS CUSTOM OLEPUBLIC

           NAME="ErrTest1"
           PROCEDURE gettime
              5 &amp;&amp;Put here to generate an error
              RETURN TIME()
           ENDPROC
        ENDDEFINE

        DEFINE CLASS ErrTest2 AS CUSTOM OLEPUBLIC
           NAME="ErrTest2"
           PROCEDURE gettime
              5 &amp;&amp;Put here to generate an error
              RETURN TIME()
           ENDPROC
        ENDDEFINE

3. Build this into an OLE .dll named OLETest1.

4. Run the following code in the Command window:

        oTmp5=CREATEOBJECT("OLETest1.ErrTest1")
        oTmp6=CREATEOBJECT("OLETest1.ErrTest2")
        *  ?oTmp5.gettime() &amp;&amp; Uncomment to show correct error.
        ?oTmp6.gettime()

This produces the following error:

  OLE IDispatch Exception Code 1031 from OLETest1.ErrTest1 ErrTest1:
  ErrTest2.gettime e:\mytest\test1.prg Error Line 13 User Interface operation
  not allowed at this time. 1031

To see the error message referencing the correct class description, uncomment the
third line of the code in step 4 and comment the fourth line.

Additional query words: kbVFp600 kbAutomation kbInterOp

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbVFP600
Version           : WINDOWS:6.0
Issue type        : kbprb
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>