<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q137729: INFO: LenB Returns in-Memory Size of User-Defined Type | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q137729: INFO: LenB Returns in-Memory Size of User-Defined Type" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/137/Q137729/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/137/Q137729/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/137/Q137729/","headline":"Q137729: INFO: LenB Returns in-Memory Size of User-Defined Type","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q137729-info-lenb-returns-in-memory-size-of-user-defined-type">Q137729: INFO: LenB Returns in-Memory Size of User-Defined Type</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q137729
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:4.0
Operating System(s): 
Keyword(s): kbenv kbprogramming kbVBp400 kb32bitOnly
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

LenB function returns the in-memory size of a user-defined type (UDT).

MORE INFORMATION
================

Visual Basic 32-bit structures are DWORD aligned (four bytes) when stored in
memory. Fixed-length strings use two bytes for every character to account for
UNICODE. String descriptors use four bytes each. Integers use two bytes. Please
refer to the Visual Basic Help file for the lengths of all the other data
types.

Example One
-----------

Consider this example UDT:

       Type Generic
       FirstName as String * 5
       LastName as String
       ChildrenAges (1 to 5) as Byte
     End Type

This UDT requires the following number of bytes:

- FirstName uses 10 bytes (UNICODE).

- LastName uses 4 bytes (String descriptor).

- ChildrenAges uses 5 bytes (5-element byte array).

Applying DWORD alignment gives a total of 21 bytes as follows:

- 8 bytes for the first 8 bytes of FirstName.

- 8 bytes for the last 2 bytes of FirstName, 2 bytes of padding, 4 bytes for
  LastName.

- 5 bytes for the 5 bytes needed for ChildrenAges.

Therefore:

     LenB(Generic) = 21
     Len (Generic) = 14

Example Two
-----------

Consider this example UDT:

        Type Generic
       FirstName as String * 7
       LastName as String * 6
       ChildrenAges (1 to 5)  as Byte
       Address * String
     End Type

This UDT requires the following number of bytes:

- FirstName uses 14 bytes (UNICODE).

- LastName uses 12 bytes (UNICODE).

- ChildrenAges uses 5 bytes (5-element byte array).

- Address uses 4 bytes (string descriptor)

Applying DWORD alignment gives a total of 36 bytes as follows:

- 8 bytes for the first 8 bytes of FirstName.

- 8 bytes for the last 6 bytes of FirstName, 2 bytes of padding, 2 bytes for
  LastName.

- 8 bytes for the next 8 bytes of LastName.

- 8 bytes for the last 2 bytes of LastName, 5 bytes for ChildrenAges, and 1
  byte of padding.

- 4 bytes for Address for the string descriptor.

Therefore:

     LenB(Generic) = 36
     Len (Generic) = 22

Additional query words:

======================================================================
Keywords          : kbenv kbprogramming kbVBp400 kb32bitOnly 
Technology        : kbVBSearch kbAudDeveloper kbVB400Search kbVB400
Version           : WINDOWS:4.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>