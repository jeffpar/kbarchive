<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q149094: HOWTO: Determine the Contents of a Cell in a DBGrid Control | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q149094: HOWTO: Determine the Contents of a Cell in a DBGrid Control" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/149/Q149094/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/149/Q149094/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/149/Q149094/","headline":"Q149094: HOWTO: Determine the Contents of a Cell in a DBGrid Control","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q149094-howto-determine-the-contents-of-a-cell-in-a-dbgrid-control">Q149094: HOWTO: Determine the Contents of a Cell in a DBGrid Control</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q149094
Product(s): Microsoft Visual Basic for Windows
Version(s): 
Operating System(s): 
Keyword(s): kbGrpDSVBDB
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, version 6.0 
- Microsoft Visual Basic Professional Edition for Windows, version 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
- Microsoft Visual Basic Control Creation Edition for Windows, version 5.0 
- Microsoft Visual Basic Learning Edition for Windows, version 5.0 
- Microsoft Visual Basic Professional Edition for Windows, version 5.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 5.0 
- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article shows how to determine the contents of a selected cell in a DBGrid
control.

MORE INFORMATION
================

The DBGrid control allows you to display the contents of a recordset or a table.
With this method, you can take the data from a cell in the MouseUp event of the
DBGrid control.

This example uses a DBGrid control bound to Data control. The Data control uses
the BIBLIO.MDB database for information. In the MouseUp event of the DBGrid
control, the column and row positions of the cell are assigned to an integer
variable. A bookmark is then set using the row position. Executing the CellValue
method on the Columns collection of the DBGrid control determines the contents
of the cell. Those contents then appear on a TextBox control.

Sample Code
-----------

1. Start Visual Basic. If it is already running, on the File menu, click New
  Project. Add a DBGrid, TextBox, and a Data control to the Form1 form. Set the
  following controls to the specified properties:

  a. Data control DatabaseName property: &lt;path&gt; BIBLIO.MDB RecordSource
     property: Titles

  b. DBGrid control DataSource property to Data1.

2. Copy the following code sample to the Form1 code window:

        Option Explicit
        Dim igColumn As Integer
        Dim igRow As Integer
        Dim vargBookmark As Variant

        Private Sub DBGrid1_MouseUp(Button As Integer, Shift As Integer, _
         X As Single, Y As Single)
           igColumn = DBGrid1.ColContaining(X)   'Set the Cell Column number
           igRow = DBGrid1.RowContaining(Y)      'Set the Cell Row number

           vargBookmark = DBGrid1.RowBookmark(igRow) 'Set Bookmark Value

           'Show the contents of the cell in a textbox
           Text1.Text = DBGrid1.Columns(igColumn).CellValue(vargBookmark)

        End Sub

3. On the Run menu, click Start or press the F5 key. Click on a cell and note
  that the contents is shown in the TextBox.

Additional query words: kbVBp400 kbVBp600 kbdse kbDSupport kbVBp kbVBp500

======================================================================
Keywords          : kbGrpDSVBDB 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVB600Search kbVBA500Search kbVBA500 kbVBA600 kbVB500 kbVB600 kbVB400Search kbVB400 kbZNotKeyword3 kbVB16bitSearch
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>