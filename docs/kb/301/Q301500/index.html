<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q301500: FIX: ASP Session Scope Thread Affinity Problem in IIS 5.0 | KnowledgeBase Archive</title>
<meta property="og:title" content="Q301500: FIX: ASP Session Scope Thread Affinity Problem in IIS 5.0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/301/Q301500/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/301/Q301500/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/301/Q301500/","publisher":null,"image":null,"headline":"Q301500: FIX: ASP Session Scope Thread Affinity Problem in IIS 5.0","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q301500-fix-asp-session-scope-thread-affinity-problem-in-iis-50">Q301500: FIX: ASP Session Scope Thread Affinity Problem in IIS 5.0</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q301500
Product(s): Internet Information Server
Version(s): 5.0
Operating System(s): 
Keyword(s): kbCOMIS kbWin2000PreSP3Fix kbWin2000sp3fix
Last Modified: 15-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Services version 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When an Active Server Pages (ASP) session accesses a session variable and then
makes a call that, because of the duration of the call, blocks other calls, some
of the user sessions are temporarily blocked until the call is completed.

This problem may also occur if you have a Global.asa file with the
Session_OnStart method or the Session_OnEnd method. This occurs even if the
method is empty.

CAUSE
=====

Microsoft Internet Information Server (IIS) 5.0 permits multiple ASP sessions to
be bound to the same physical thread.

NOTE: This behavior is a change from IIS 4.0.

If there are two sessions tied to the same physical thread, and the first session
makes a call that takes awhile to complete, the second thread must wait until
the call is completed to get a response for its request.

RESOLUTION
==========

To resolve this problem, obtain Microsoft COM+ Hotfix Rollup 18.1. For
additional information about the Hotfix Rollup, click the article number below
to view the article in the Microsoft Knowledge Base:

  Q313582 INFO: Availability of Windows 2000 Post-SP2 COM+ Hotfix 18.1

To resolve this problem, obtain the latest service pack for Windows 2000. For
additional information, click the following article number to view the article
in the Microsoft Knowledge Base:

  Q260910 How to Obtain the Latest Windows 2000 Service Pack



STATUS
======

Microsoft has confirmed that this is a problem in the Microsoft products that
are listed at the beginning of this article. This problem was first corrected in
Windows 2000 Service Pack 3.

Additional query words: kbIISCom kbWin2000preSP3COMRollup14Fix kbWin2000PreSP3Fix kbWin2000preSP3COMRollup18Fix

======================================================================
Keywords          : kbCOMIS kbWin2000PreSP3Fix kbWin2000sp3fix 
Technology        : kbiisSearch kbiis500
Version           : :5.0
Hardware          : ALPHA x86
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>