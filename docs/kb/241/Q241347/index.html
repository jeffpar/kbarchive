<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q241347: FIX: Inserting/Updating Dates Before &quot;01-01-1900&quot; Into SQL | KnowledgeBase Archive</title>
<meta property="og:title" content="Q241347: FIX: Inserting/Updating Dates Before &quot;01-01-1900&quot; Into SQL" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/241/Q241347/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/241/Q241347/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/241/Q241347/","publisher":null,"image":null,"headline":"Q241347: FIX: Inserting/Updating Dates Before &quot;01-01-1900&quot; Into SQL","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q241347-fix-insertingupdating-dates-before-01-01-1900-into-sql">Q241347: FIX: Inserting/Updating Dates Before "01-01-1900" Into SQL</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q241347
Product(s): Open Database Connectivity (ODBC)
Version(s): 2.1,2.5,2.6,2.7
Operating System(s): 
Keyword(s): kbJDBC kbODBC kbGrpDSVCDB kbGrpDSMDAC kbDSupport kbMDAC250bug kbMDAC260bug kbmdac270 kb
Last Modified: 27-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft ODBC for JDBC (Build 5.00.3591) 
- Microsoft Data Access Components versions 2.1, 2.5, 2.6, 2.7 
-------------------------------------------------------------------------------

SYMPTOMS
========

When using the Java Database Connectivity (JDBC) - Open Database Connectivity
(ODBC) bridge to insert or update dates prior to "01-01-1900" into SQL server
(version 6.5 and 7.0), the following error occurs consistently:

  22008 [Microsoft][ODBC SQL Server Driver]Datetime field overflow.

For those inserts or updates that are successful (for dates after 01-01-1900),
truncation (of the datetime columns) occurs. So, when displaying the row in the
database, the seconds and milliseconds portion of the datetime columns are
always 0 (zero) even though the date/time fields that are bound have non-zero
values for seconds and milliseconds.

CAUSE
=====

The JDBC-ODBC bridge (msjdbc10.dll) is binding the datetime column incorrectly.

RESOLUTION
==========

Microsoft has confirmed this to be a bug in the JDBC-ODBC bridge (Msjdbc10.dll,
version 5.00.3155). This bug has been fixed in Microsoft VM for Java, builds
3234 (which shipped with Microsoft Internet Explorer version 5.01 and Windows
2000) and later.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

MORE INFORMATION
================

This problem happens when you use the latest JDBC-ODBC bridge (Msjdbc10.dll
version 5.00.3155) and Microsoft Data Access Components (MDAC) 2.1 GA and later.
Uninstalling MDAC 2.1 and re-installing MDAC 2.0 SP2 seems to fix the problem.

You can use Microsoft Component Checker to uninstall any version of MDAC in a
computer running Windows 95, Windows 98, or Windows NT.

For detailed information on Component Checker see the following Microsoft Web
site:

  http://www.microsoft.com/data

Additional query words: msjdbc10.dll, datetime binding

======================================================================
Keywords          : kbJDBC kbODBC kbGrpDSVCDB kbGrpDSMDAC kbDSupport kbMDAC250bug kbMDAC260bug kbmdac270 kbmdac270bug 
Technology        : kbAudDeveloper kbODBCSearch kbMDACSearch kbMDAC210 kbMDAC250 kbMDAC260
Version           : :2.1,2.5,2.6,2.7
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>