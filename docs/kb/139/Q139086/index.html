<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q139086: How to Update Files in Use by Windows | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q139086: How to Update Files in Use by Windows" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/139/Q139086/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/139/Q139086/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/139/Q139086/","headline":"Q139086: How to Update Files in Use by Windows","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q139086-how-to-update-files-in-use-by-windows">Q139086: How to Update Files in Use by Windows</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q139086
Product(s): Microsoft Systems Management Server
Version(s): winnt:1.0,1.1,1.2
Operating System(s): 
Keyword(s): kbsetup smssetup
Last Modified: 27-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server versions 1.0, 1.1, 1.2 
-------------------------------------------------------------------------------

SUMMARY
=======

If you attempt to update Windows client system files that are currently in use,
the update fails and the files are not overwritten. This article outlines a
procedure that you can use to ensure these files are updated when you restart
the computer. The procedure is not supported and may be used at your own risk.
The SMSWORK component can change in future releases of Systems Management
Server.

MORE INFORMATION
================

The C:\SMS.INI file can include a [SMS Work] section, and a PendingWork key. For
this key, you can create a comma separated list of commands for the SMSWORK.EXE
component of Systems Management Server. SMSWORK.EXE executes these commands when
AUTOEXEC.BAT calls the Systems Management Server batch file, CLIENT.BAT.

For example, if you want to update the NETAPI.DLL file in the C:\WINDOWS\SYSTEM
directory, do the following:

1. Use Microsoft Test or another method to update SMS.INI as follows:

        [SMS Work]
        PendingWork=copy c:\temp\netapi.dll c:\windows\system\netapi.dll /y,
        del c:\temp\netapi.dll

  NOTE: SMS.INI is a critical file for the Systems Management Server client and
  great care should be taken when altering it. SMS.INI has the file attribute
  Hidden. Be sure to restore the Hidden file attribute after you remove it.

2. In the script you use, place the new version of NETAPI.DLL into the c:\TEMP
  directory and possibly notify the user that a reboot is needed.

In this example, when the client reboots, AUTOEXEC.BAT calls CLIENT.BAT, which
invokes SMSWORK.EXE. SMSWORK reads the items from PendingWork and executes them
as separate commands according to where you place the comma starting with the
left command first. SMSWORK then copies NETAPI.DLL over the old one, and the
next command deletes the temporary version of NETAPI.DLL. Following each
command, SMSWORK automatically removes the executed command from the PendingWork
key.

By design, SMSWORK is a helper component to the modules that perform operating
system upgrades and installs. SMSWORK helps these modules by removing local
temporary directories created during the operating system setup or undoes other
actions taken by these modules, when the system reboots.

Additional query words: prodsms

======================================================================
Keywords          : kbsetup smssetup 
Technology        : kbSMSSearch kbSMS100 kbSMS110 kbSMS120
Version           : winnt:1.0,1.1,1.2
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>