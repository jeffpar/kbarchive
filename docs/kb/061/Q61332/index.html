<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q61332: Storage Format for MKI$, MKL$, MKS$, MKD$ Same as Variable | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q61332: Storage Format for MKI$, MKL$, MKS$, MKD$ Same as Variable" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/061/Q61332/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/061/Q61332/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/061/Q61332/","headline":"Q61332: Storage Format for MKI$, MKL$, MKS$, MKD$ Same as Variable","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q61332-storage-format-for-mki-mkl-mks-mkd-same-as-variable">Q61332: Storage Format for MKI$, MKL$, MKS$, MKD$ Same as Variable</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q61332
Product(s): See article
Version(s): 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S900403-6 B_BasicCom | mspl13_basic
Last Modified: 29-JAN-1991

The MKS$, MKI$, MKL$, and MKD$ functions are used in Microsoft
QuickBASIC to convert numeric data to strings for use in random access
files. The actual conversion of the numbers to strings is just a
transfer of the binary representation of the number. If you look at a
binary representation of both a numeric variable and the string
equivalent made with the MKS$, MKI$, MKL$, or MKD$ function, you will
see that they are exactly the same (with the exception of MKS$ and
MKD$ when compiling with the /MBF option).

This information applies to Microsoft QuickBASIC versions 4.00, 4.00b,
and 4.50, to Microsoft BASIC Compiler versions 6.00 and 6.00b, and to
Microsoft BASIC Professional Development System (PDS) versions 7.00
and 7.10. Note that BASIC PDS also provides MKC$, for the CURRENCY
data type.

The binary numeric format stored in numeric variables versus MKS$ or
MKD$ strings differs if you invoke the QuickBASIC environment (QB.EXE
or QBX.EXE) or the BC.EXE compiler with the /MBF option (which makes
MKS$ and MKD$ behave just like the MKSMBF$ and MKDMBF$ functions). The
/MBF (Microsoft Binary Format) option makes MKS$ and MKD$ return MBF
strings instead of IEEE format strings.

Code Sample
-----------

Both the integer and the string equivalent in the following program
are stored in 2 bytes in memory. This program prints out the numeric
value of the binary content of the locations that A% and A$ are kept
in. As the output of this program demonstrates, the binary
representation of the two values is the same.

This program prints a series of numbers both as decimal numbers and as
their MKI$ equivalent. Then it prints out the information stored in
the 2-byte locations in memory for both the numeric and string data.
When you run the program, note the difference in the binary storage of
the numbers when the value increments from 255 to 256 (requiring a bit
in the higher byte).

CLS
FOR a% = 252 TO 259
  a$ = MKI$(a%)
  PRINT "Number:"; a%, "String: "; a$
  aseg = VARSEG(a%)
  aptr = VARPTR(a%)
  asseg = VARSEG(a$)
  asptr = SADD(a$)
  DEF SEG = aseg
  aval1 = PEEK(aptr): aval2 = PEEK(aptr + 1)
  DEF SEG = asseg
  asval1 = PEEK(asptr): asval2 = PEEK(asptr + 1)
  PRINT aval1, aval2, , asval1, asval2
NEXT a%
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>