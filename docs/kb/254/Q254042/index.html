<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q254042: Preserve Custom Services File When Installing Network Components | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q254042: Preserve Custom Services File When Installing Network Components" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/254/Q254042/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/254/Q254042/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/254/Q254042/","headline":"Q254042: Preserve Custom Services File When Installing Network Components","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q254042-preserve-custom-services-file-when-installing-network-components">Q254042: Preserve Custom Services File When Installing Network Components</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q254042
Product(s): Microsoft Windows 95.x Retail Product
Version(s): Win2000:95
Operating System(s): 
Keyword(s): kbenv kbnetwork dun win95 kbDialUp
Last Modified: 28-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows 95 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you apply the Dial-Up Networking (DUN) 1.3 update to a Windows 95-based
computer, the Services file is overwritten. The Services file is also
overwritten when you reinstall network components such as protocols or network
adapter drivers.

The Services file is located in the Windows folder. It is used to store network
resource mapping information such as drives, printers, and ports. Network
administrators may prefer to have a modified Services file preserved under all
circumstances. This article describes how you can prevent the customized
Services file from being overwritten during network component installation.

CAUSE
=====

When you install network components such as DUN 1.3, a new copy of the Services
file is extracted from the Windows cabinet file to the Windows folder, where it
overwrites any existing modified Services file. This is the default behavior in
Windows 95.

RESOLUTION
==========

You can prevent your custom Services file from being overwritten when you
install network components by modifying a line in the Nettrans.inf file at the
installation source.

Use any text editor (such as Notepad) to edit the Nettrans.inf file. Locate the
[MSTCP.CopyFiles.win] section in the file, and then modify the Services file
entry in the Nettrans.inf file as follows:

  services,,,16,

"16" is a flag that indicates that the file should not be overwritten if it
already exists.

STATUS
======

This behavior is by design.

MORE INFORMATION
================

Make sure to modify the Nettrans.inf file at the installation source (typically
a flat folder), not the copy of Nettrans.inf file that is located in the
Windows\Inf folder. Any changes you make to the Nettrans.inf file in the
Windows\Inf folder are overwritten from the installation source folder.

Additional query words:

======================================================================
Keywords          : kbenv kbnetwork dun win95 kbDialUp 
Technology        : kbWin95search kbZNotKeyword3
Version           : Win2000:95
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>