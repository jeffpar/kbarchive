<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q138311: PRB: Mapi Session Control and Exchange May Cause Errors | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q138311: PRB: Mapi Session Control and Exchange May Cause Errors" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/138/Q138311/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/138/Q138311/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/138/Q138311/","headline":"Q138311: PRB: Mapi Session Control and Exchange May Cause Errors","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q138311-prb-mapi-session-control-and-exchange-may-cause-errors">Q138311: PRB: Mapi Session Control and Exchange May Cause Errors</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q138311
Product(s): Microsoft FoxPro
Version(s): 3.00
Operating System(s): 
Keyword(s): 
Last Modified: 10-MAR-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

Using the MAPI Session Control that comes with Visual FoxPro 3.0 and Exchange
that comes with Windows 95 may result in the following error when you attempt to
log on:

  OLE Idispatch exception code 0 from MSMAPI32: Login has failed

The following error occurs if the LogonUI property is set to false (.F.):

  The profile name is incorrect.

This warning appears if anything other than the profile name is entered into the
Username property. The Password property is ignored.

CAUSE
=====

The Mapi.ocx file that ships with Visual FoxPro 3.0 is only compatible with
Microsoft Mail, not with Exchange. The Mapi.ocx file and Microsoft Mail use an
earlier version of MAPI, whereas Exchange uses MAPI version 1.0.

WORKAROUND
==========

To work around this incompatibility, do one of the following:

- Have a session of Exchange currently running; then the error messages will
  not appear.

- Place the profile name in the Username property. This avoids the warning
  message of "Invalid Profile name" and the Logon prompt for MS Exchange.

- Use OLE Messaging by using OLE Automation to MAPI.

  For more information about using the OLE Messaging object, please see the
  September 1995 Microsoft Developer Network (MSDN) Level II CD-ROM compact
  disc, which contains the MAPI software development kit (SDK) and files
  necessary to get OLE Messaging to work with Visual FoxPro.



STATUS
======

Microsoft is researching this behavior and will post new information here in the
Microsoft Knowledge Base as it becomes available.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Create a new form, and add MAPI Session Control to the form.

2. Right-click the icon for the MAPI Session Control, and choose properties.

3. Clear the LogonUI check box, and select the NewSession check box.

4. Run the form. At this point, an error message appears.

Additional query words: VFoxWin MSMAPI Mail OCX

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : 3.00
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>