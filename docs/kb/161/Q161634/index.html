<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q161634: INF: Connection Pooling Requires Same Henv and Driver | KnowledgeBase Archive</title>
<meta property="og:title" content="Q161634: INF: Connection Pooling Requires Same Henv and Driver" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/161/Q161634/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/161/Q161634/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/161/Q161634/","publisher":null,"image":null,"headline":"Q161634: INF: Connection Pooling Requires Same Henv and Driver","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q161634-inf-connection-pooling-requires-same-henv-and-driver">Q161634: INF: Connection Pooling Requires Same Henv and Driver</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q161634
Product(s): Open Database Connectivity (ODBC)
Version(s): WINDOWS:3.0
Operating System(s): 
Keyword(s): 
Last Modified: 26-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Open Database Connectivity, version 3.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article describes the relationships of connection pooling, environments,
and drivers.

MORE INFORMATION
================

Connection pooling is one the new features introduced in ODBC 3.0. Connection
pooling enables an ODBC application to reuse a connection from a pool of
connections. Once a connection has been created and placed in the pool, an ODBC
application can reuse the same driver and the connection within the same
environment (henv) without performing the complete connection process.
Connection can never be reused between different henv or different drivers.

You can use the SQLSetEnvAttr function call to enable connection pooling. There
are two attributes available for connection pooling under the SQLSetEnvAttr
function: SQL_CP_ONE_PER_HENV and SQL_CP_ONE_PER_DRIVER. The difference between
these two attributes is a performance/comparison consideration, and the use of
any one of these options does not change which connection is reused.

With the SQL_CP_ONE_PER_HENV attribute, a comparison pool is created for each
henv. The pool may include connections from different drivers within the same
environment. The ODBC driver manager searches this pool for the driver that
matches the requested connection. You normally use this option if there are many
henvs but few drivers, because it saves you the number of comparisons (with the
cost of memory for the pools).

With the SQL_CP_ONE_PER_DRIVER attribute, a comparison pool is created for each
driver. The pool may include different henvs that use the same driver. The ODBC
driver manager searches this pool for the henv that matches the requested
connection. You normally use this option if there are many drivers but few
henvs, for the same reason in the previous paragraph.

The ODBC 3.0 API online Help version 4.00.950 mistakenly states that you can
share connections between different environments with the SQL_CP_ONE_PER_HENV
attribute. Connections can only be reused within the same henv and the same
driver. Connections can never be reused between different henvs or different
drivers.

Additional query words: viper sql memory leak

======================================================================
Keywords          :  
Technology        : kbAudDeveloper kbODBCSearch kbODBC300
Version           : WINDOWS:3.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>