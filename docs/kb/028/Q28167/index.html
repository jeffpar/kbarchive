<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q28167: Long Integer Passed to SUB and Modified May Not Return OK | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q28167: Long Integer Passed to SUB and Modified May Not Return OK" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/028/Q28167/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/028/Q28167/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/028/Q28167/","headline":"Q28167: Long Integer Passed to SUB and Modified May Not Return OK","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q28167-long-integer-passed-to-sub-and-modified-may-not-return-ok">Q28167: Long Integer Passed to SUB and Modified May Not Return OK</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q28167
Product(s): See article
Version(s): 4.00 4.00b
Operating System(s): MS-DOS
Keyword(s): ENDUSER | B_BasicCom buglist4.00 buglist4.00b fixlist4.50 | mspl13_basic
Last Modified: 31-JAN-1990

When a long integer is passed to a subprogram as a parameter and its
value is changed, the change is reflected only inside the subprogram
in the code example below. When control is returned to the main
section of the program, the variable incorrectly has its original
value, instead of the changed value.

The problem occurs only when running the program as an .EXE file;
the program works correctly in the QB.EXE interpreter.

This problem occurs in QuickBASIC Versions 4.00 and 4.00b, and in
Microsoft BASIC Compiler Versions 6.00 and 6.00b for MS-DOS and OS/2
(buglist6.00 and buglist6.00b). This problem was corrected in
QuickBASIC Version 4.50 and in Microsoft BASIC Professional
Development System (PDS) Version 7.00 for MS-DOS and MS OS/2
(fixlist7.00).

The problem results from the passing of a long integer to the
subprogram. If the variable type is changed (that is, b&amp; becomes b!,
which is a change from a long integer to a single-precision real
number), the problem is corrected.

The following are three workarounds:

1. Put the long integer into a COMMON SHARED block instead of passing
   it as a parameter.

2. In the subprogram, assign the VAL expression to a temporary
   variable and use this temporary variable in the reassignment of the
   long integer.

3. Change the variable type to anything but a long integer.

The following is a code example that demonstrates the problem:

DECLARE SUB sub1 (b&amp;, a$)
a$ = "002": b&amp; = 1
b&amp; = b&amp; + VAL(a$)
PRINT "main -- before: "; b&amp;
CALL sub1(b&amp;, a$)
'Output in editor is 5; from EXE is 3 (wrong):
PRINT "main -- after: "; b&amp;
END
SUB sub1 (b&amp;, a$) STATIC
   PRINT "subprogram -- before: "; b&amp;
   b&amp; = b&amp; + VAL(a$)
   PRINT "subprogram -- after: "; b&amp;
END SUB
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>