<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q59725: INTERRUPT for Clock Tick Counter Returns Negative Value | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q59725: INTERRUPT for Clock Tick Counter Returns Negative Value" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/059/Q59725/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/059/Q59725/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/059/Q59725/","headline":"Q59725: INTERRUPT for Clock Tick Counter Returns Negative Value","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q59725-interrupt-for-clock-tick-counter-returns-negative-value">Q59725: INTERRUPT for Clock Tick Counter Returns Negative Value</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q59725
Product(s): See article
Version(s): 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S900222-218 B_BasicCom | mspl13_basic
Last Modified: 26-MAR-1990

Interrupt 1A Hex, with Function 0, returns the current value of the
clock tick counter in registers CX and DX. When the low-order portion
of the clock tick counter (returned in DX) exceeds 32,767, it becomes
negative when stored as an integer in BASIC, because 32,767 is the
maximum value for a 2-byte signed integer. Below is an example to
convert the negative value to the equivalent unsigned long integer
value.

This information applies to Microsoft QuickBASIC Versions 4.00, 4.00b,
and 4.50, to Microsoft BASIC Compiler Versions 6.00 and 6.00b, and to
Microsoft BASIC Professional Development System (PDS) Version 7.00 for
MS-DOS.

For a more complete description of converting negative signed integers
to unsigned integers, query on the following words:

   CALL and INTERRUPT and negative and signed and integer

The following QuickBASIC program outputs only positive values by
removing the sign bit and adding the remaining number plus 1 to
32,767:

' $INCLUDE: 'qb.bi'
REM  In BASIC 7.00, use $INCLUDE: 'qbx.bi' instead of 'qb.bi'.
REM  To use CALL INTERRUPT in this program, you must do the following:
REM  If you run this program in QB.EXE, use QB /L QB.QLB.
REM  If you run this program in QBX.EXE, use QBX /L QBX.QLB.
REM  LINK with QB.LIB (or QBX.LIB for BASIC 7.00).

DIM inregs AS regtype, outregs AS regtype
LOCATE 23, 1: PRINT "Push any key to end program."
DO
inregs.ax = 0
CALL interrupt(&amp;H1A, inregs, outregs)
high&amp; = outregs.cx
low&amp; = outregs.dx
IF low&amp; &lt; 0 THEN              'if the low-order portion is negative:
  low&amp; = low&amp; AND &amp;H7FFF      'remove sign bit
  low&amp; = low&amp; + &amp;H7FFF + 1    'add remaining number plus 1 to 32,767
END IF
LOCATE 24, 1: PRINT high&amp;; ":"; low&amp;; "   ";
LOOP UNTIL INKEY$ &lt;&gt; ""
END
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>