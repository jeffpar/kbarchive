<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q248283: SMS: Query for IP Address and Subnet Returns Unexpected Results | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q248283: SMS: Query for IP Address and Subnet Returns Unexpected Results" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/248/Q248283/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/248/Q248283/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/248/Q248283/","headline":"Q248283: SMS: Query for IP Address and Subnet Returns Unexpected Results","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q248283-sms-query-for-ip-address-and-subnet-returns-unexpected-results">Q248283: SMS: Query for IP Address and Subnet Returns Unexpected Results</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q248283
Product(s): Microsoft Systems Management Server
Version(s): winnt:2.0,2.0 SP1
Operating System(s): 
Keyword(s): kbsms200 smsinst
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server versions 2.0, 2.0 SP1 
-------------------------------------------------------------------------------

SYMPTOMS
========

Queries against discovery data in the Systems Management Server (SMS) 2.0
database may return unexpected results or incorrect data.

CAUSE
=====

This behavior occurs because the relationship between a given IP address and its
subnet is not stored in the discovery data portion of the database.

WORKAROUND
==========

If the resource is a client and hardware inventory has been collected, use the
Hardware Inventory classes to obtain this information because this relationship
is stored appropriately. For more information about writing queries for the SMS
database, see the Microsoft Systems Management Server 2.0 Software Developers
Kit, which is included with the Microsoft BackOffice Resource Kit version 4.5.

MORE INFORMATION
================

You cannot obtain accurate results because the relationship between a given IP
address and its corresponding IP subnet is not explicitly stored in the
discovery tables in the database. When a computer has only one IP address, this
relationship is implied because there is only one subnet associated with the
resource. However, if a resource has multiple IP addresses and multiple IP
subnets, there is no association between a given IP address and a given subnet
that is stored in the database.

For example, if you build a query to return a list of computer names, IP
addresses, and IP subnets for all computer that are running Windows NT, the
result set includes multiple rows for those computers that have more than one IP
address. There is a row in the result set for each combination of IP addresses
and subnet addresses that is possible. A resource that has &lt;n&gt; adapters,
each on a different IP subnet, has &lt;n&gt;^2 rows in the result set.
Therefore, a resource with 3 IP addresses and subnets has 9 rows; a computer
with 100 IP addresses and 100 corresponding subnet addresses may have as many as
10,000 rows.

Additional query words: prodsms

======================================================================
Keywords          : kbsms200 smsinst 
Technology        : kbSMSSearch kbSMS200 kbSMS200SP1
Version           : winnt:2.0,2.0 SP1
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>