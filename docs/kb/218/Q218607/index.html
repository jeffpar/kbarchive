<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q218607: HOW TO: Create a File Defining the Constants for Use w/CDONTS | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q218607: HOW TO: Create a File Defining the Constants for Use w/CDONTS" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/218/Q218607/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/218/Q218607/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/218/Q218607/","headline":"Q218607: HOW TO: Create a File Defining the Constants for Use w/CDONTS","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q218607-how-to-create-a-file-defining-the-constants-for-use-wcdonts">Q218607: HOW TO: Create a File Defining the Constants for Use w/CDONTS</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q218607
Product(s): Internet Information Server
Version(s): 4.0,5.0
Operating System(s): 
Keyword(s): kbHOWTOmaster
Last Modified: 08-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Services version 5.0 
- Microsoft Internet Information Server version 4.0 
-------------------------------------------------------------------------------


IN THIS TASK
------------

- SUMMARY

   - How to Include the Code in ASP

- REFERENCES

SUMMARY
=======

This article explains how to take advantage of Collaboration Data Objects (CDO).
The NT Option Pack (NTOP) exposed CDO for Windows NT Server (CDONTS) provides
the Active Server Pages (ASP) page an easier method for sending mail. This
article describes how to create a file that defines the constants for use with
the CDONTS.NewMail object.

How to Include the Code in ASP
------------------------------

WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this code "as is" without warranty of any kind, either
express or implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.

To include the code in an ASP page, use the Server Side Includes (SSI) syntax to
reference the path to the file:

  <span class="c">&lt;!--#include virtual="/cdovbs.inc"--&gt;</span>

To use this page, copy the following ASP code, and then save it as "Cdovbs.inc"
(without the quotation marks) in the root directory of a Web site:

  <span class="nt">&lt;</span><span class="err">%</span>
  <span class="err">'</span><span class="na">--------------------------------------------------------------------</span>
  <span class="err">'</span> <span class="na">Microsoft</span> <span class="na">CDONTS</span><span class="err">.</span><span class="na">NewMail</span>
  <span class="err">'</span>
  <span class="err">'</span> <span class="err">(</span><span class="na">c</span><span class="err">)</span> <span class="na">1999</span> <span class="na">Microsoft</span> <span class="na">Corporation</span><span class="err">.</span>  <span class="na">All</span> <span class="na">Rights</span> <span class="na">Reserved</span><span class="err">.</span>
  <span class="err">'</span>
  <span class="err">'</span> <span class="na">More</span> <span class="na">NT</span> <span class="na">Option</span> <span class="na">Pack</span> <span class="na">Documentation:</span>
  <span class="err">'</span>   <span class="na">http:</span><span class="err">//&lt;</span><span class="na">ServerName</span><span class="nt">&gt;</span>/iishelp/iis/htm/asp/amsm0qzj.htm
  '
  ' CDONTS.NewMail constants include file for VBScript
  '
  '--------------------------------------------------------------------

  '---- BodyFormat Property ----
  Const CdoBodyFormatHTML	= 0	' The Body property is to include Hypertext Markup Language (HTML).
  Const CdoBodyFormatText	= 1	' The Body property is to be exclusively in plain text (default value).

  '---- MailFormat Property ----
  Const CdoMailFormatMime	= 0	' The NewMail object is to be in MIME format.
  Const CdoMailFormatText	= 1	' The NewMail object is to be in uninterrupted plain text (default value).

  '---- Importance Property ----
  Const CdoLow	= 0		' Low importance
  Const CdoNormal	= 1		' Normal importance (default)
  Const CdoHigh	= 2		' High importance

  '---- AttachFile and AttachURL Methods ----
  Const CdoEncodingUUencode	= 0	' The attachment is to be in UUEncode format (default).
  Const CdoEncodingBase64		= 1	' The attachment is to be in base 64 format.
  %&gt;

The following is a sample ASP page that uses the preceding code:

  <span class="nt">&lt;</span><span class="err">%@</span><span class="na">LANGUAGE=</span><span class="s">"VBSCRIPT"</span><span class="err">%</span><span class="nt">&gt;</span>
  <span class="nt">&lt;</span><span class="err">%</span>
  	<span class="na">Option</span> <span class="na">Explicit</span>
  	<span class="na">Dim</span> <span class="na">objNewMail</span>
  <span class="err">%</span><span class="nt">&gt;</span>
  <span class="c">&lt;!--#include virtual="/cdovbs.inc"--&gt;</span>
  <span class="nt">&lt;</span><span class="err">%</span>
  	<span class="na">Set</span> <span class="na">objNewMail =</span><span class="err"> </span><span class="s">Server.CreateObject("CDONTS.NewMail")</span>
  	<span class="na">objNewMail</span><span class="err">.</span><span class="na">From =</span><span class="err"> </span><span class="s">"someone@example.com"</span>
  	<span class="na">objNewMail</span><span class="err">.</span><span class="na">To =</span><span class="err"> </span><span class="s">"someone@example.com"</span>
  	<span class="na">objNewMail</span><span class="err">.</span><span class="na">Subject =</span><span class="err"> </span><span class="s">"This is a test message"</span>
  	<span class="na">objNewMail</span><span class="err">.</span><span class="na">Body =</span><span class="err"> </span><span class="s">"This is a test message"</span>
  	<span class="na">objNewMail</span><span class="err">.</span><span class="na">BodyFormat =</span><span class="err"> </span><span class="s">CdoBodyFormatText</span>
  	<span class="na">objNewMail</span><span class="err">.</span><span class="na">MailFormat =</span><span class="err"> </span><span class="s">CdoMailFormatText</span>
  	<span class="na">objNewMail</span><span class="err">.</span><span class="na">Importance =</span><span class="err"> </span><span class="s">CdoNormal</span>
  	<span class="na">objNewMail</span><span class="err">.</span><span class="na">Send</span>
  	<span class="na">Set</span> <span class="na">objNewMail =</span><span class="err"> </span><span class="s">Nothing</span>
  <span class="err">%</span><span class="nt">&gt;</span>
  <span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;&lt;title&gt;</span>CDONTS.NewMail Test<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  Your mail has been sent!
  <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>

REFERENCES
==========

For more information about Microsoft scripting technologies, visit the following
MSDN Web site:

  http://msdn.microsoft.com/scripting

Additional query words:

======================================================================
Keywords          : kbHOWTOmaster 
Technology        : kbiisSearch kbiis500 kbiis400
Version           : :4.0,5.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>