<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q102920: FIX: Linker May Cause L5000 with CodeView Information | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q102920: FIX: Linker May Cause L5000 with CodeView Information" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/102/Q102920/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/102/Q102920/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/102/Q102920/","headline":"Q102920: FIX: Linker May Cause L5000 with CodeView Information","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q102920-fix-linker-may-cause-l5000-with-codeview-information">Q102920: FIX: Linker May Cause L5000 with CodeView Information</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q102920
Product(s): Microsoft Programming Utilities
Version(s): 5.5,5.6
Operating System(s): 
Keyword(s): kb16bitonly
Last Modified: 30-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft LINK for MS-DOS, versions 5.5, 5.6 
-------------------------------------------------------------------------------

SYMPTOMS
========

Linking a large number of object modules and libraries with the /CO option for
CodeView information may generate the following error message:

  LINK : fatal error L5000:

CAUSE
=====

This problem is typically caused when the linker, LINK.EXE, gets to the CodeView
information packing stage while generating a large .EXE file.

RESOLUTION
==========

Use one or more of the following to work around this problem:

- Link without the /CO option if the application doesn't need to be debugged.

- Link with the /CO:NOCVPACK option to create an .EXE file with unpacked
  CodeView information, and then run CVPACK.EXE separately on the .EXE. The
  CVPACK.EXE utility in the \MSVC\BIN directory by default. For more
  information about CVPACK, select the "Tech Notes" icon in your Visual C++
  Program Manager group. You'll see a help button that reads "Using CVPACK."

- Reduce the amount of CodeView information for the application by compiling
  only the essential modules with the /Zi option; compile the rest with the /Zd
  option.

- Avoid linking OLDNAMES.LIB last.

- If using the /LI linker option, remove it.

- Assign the TMP environment variable a valid hard drive and directory with a
  large amount of disk space (preferably not a RAM drive).

STATUS
======

Microsoft has confirmed this to be a problem in the versions of the linker given
at the beginning of this article. Some causes of this problem have been fixed in
Visual C++ 1.52, but in some instances, you may still need to use /CO:NOCVPACK
and then use cvpack on the exe.

Additional query words: 5.50 5.60 5.60.220 5.60.339 /CO:N visualc no32bit

======================================================================
Keywords          : kb16bitonly 
Technology        : kbAudDeveloper kbZNotKeyword3 kbLINKSearch kbLINK550DOS kbLINK560DOS
Version           : :5.5,5.6
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>