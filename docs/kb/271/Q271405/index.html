<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q271405: PRB: Batch Files Do Not Run as Post Executables in Setup | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q271405: PRB: Batch Files Do Not Run as Post Executables in Setup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/271/Q271405/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/271/Q271405/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/271/Q271405/","headline":"Q271405: PRB: Batch Files Do Not Run as Post Executables in Setup","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q271405-prb-batch-files-do-not-run-as-post-executables-in-setup">Q271405: PRB: Batch Files Do Not Run as Post Executables in Setup</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q271405
Product(s): Microsoft FoxPro
Version(s): WINDOWS:5.0,5.0a,6.0
Operating System(s): 
Keyword(s): kbwizard kbAppSetup kbOSWinNT400 kbOSWin2000 kbvfp500 kbvfp500a kbvfp500aBUG kbvfp500aF
Last Modified: 24-OCT-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a, 6.0, on platform(s):
   - the operating system: Microsoft Windows NT 
   - the operating system: Microsoft Windows 2000 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you try to run a batch file as a post executable in an setup package built
by Visual FoxPro's Setup Wizard, the batch file does not execute if it is run on
a Microsoft Windows NT 4.0 or a Microsoft Windows 2000-based operating system.
The batch file does execute properly if it is run on Microsoft Windows 9X-based
operating systems.

MORE INFORMATION
================

In step 4 of the Visual FoxPro Setup Wizard, there is a Post-Setup Executable
text box. The file specified in this box runs at the end of the setup package
created by the wizard. This file is usually an executable (.exe) or batch (.bat)
file. An .exe executes at the end of the setup routine regardless of what
operating system is running, but a .bat file does not execute on NT 4.0 or
Windows 2000-based operating systems.

NOTE: .CMD files, an alternative to batch files on Windows NT and Windows 2000
computers, also do not run as Post-Setup Executables.


Steps to Reproduce Behavior
---------------------------

1. Create a batch file called "Do_Batch.bat" (without the quotation marks) in a
  new folder, and then add some DOS commands, such as:

  CD C:\ 
  MD Mybatch

If the batch file executes properly, a folder called Mybatch is created on the C:
drive.

2. Create a Visual FoxPro executable in the same folder as the batch file. The
  .exe can be small; a .prg with a WAIT WINDOW command will do.

3. Run the Visual FoxPro Setup Wizard, pointing to the files that are in the
  folder created in step 1. Type the file name "Do_Batch.bat" (without the
  quotation marks) in the Post-Executable text box in step 4.

4. Select Finish in step 6 of the Setup Wizard, allow the setup package to be
  created, and then run Setup.exe to start the installation. If you are doing
  this on a NT 4.0 or Windows 2000 computer, note that the batch file does not
  execute as a Post-Setup Executable.

5. Note that when you are running the setup routine on a Win 9X computer, the
  batch file executes successfully.

REFERENCES
==========

For additional information on the post-setup option in the Visual FoxPro Setup
Wizard, click the article numbers below to view the articles in the Microsoft
Knowledge Base:

  Q176887 FIX: Running VFP Exe as Post-Setup Executable Hangs the Process

  Q194434 HOWTO: Using the Setup Wizard in Visual FoxPro 6.0

Additional query words:

======================================================================
Keywords          : kbwizard kbAppSetup kbOSWinNT400 kbOSWin2000 kbvfp500 kbvfp500a kbvfp500aBUG kbvfp500aFIX kbvfp600 kbvfp600bug kbGrpDSFox kbDSupport 
Technology        : kbVFPsearch kbAudDeveloper
Version           : WINDOWS:5.0,5.0a,6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>