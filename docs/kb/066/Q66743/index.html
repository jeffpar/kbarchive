<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q66743: GAMESHOP.EXE &quot;Error 05&quot;, Using SET COMSPEC=COMMAND.COM /E:n | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q66743: GAMESHOP.EXE &quot;Error 05&quot;, Using SET COMSPEC=COMMAND.COM /E:n" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/066/Q66743/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/066/Q66743/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/066/Q66743/","headline":"Q66743: GAMESHOP.EXE &quot;Error 05&quot;, Using SET COMSPEC=COMMAND.COM /E:n","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q66743-gameshopexe-error-05-using-set-comspeccommandcom-en">Q66743: GAMESHOP.EXE "Error 05", Using SET COMSPEC=COMMAND.COM /E:n</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q66743
Product(s): See article
Version(s): 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S901101-34 | mspl13_basic
Last Modified: 5-DEC-1990

GAMESHOP.EXE blanks the screen or gives "Error 5" if you mistakenly
use the COMMAND.COM /E:n option in the COMSPEC environment variable in
MS-DOS (such as in your AUTOEXEC.BAT file). The following is an
example:

   SET COMSPEC=C:\DOS\COMMAND.COM /E:256

This is not considered a problem with Microsoft Game Shop because you
should normally use only COMMAND.COM /E:n on your SHELL= command in
your MS-DOS CONFIG.SYS file.

This information applies to Microsoft Game Shop (released October 15,
1990) for MS-DOS. (Microsoft Game Shop contains the QuickBASIC QBI.EXE
interpreter version 1.00, which supports the BASIC language defined by
Microsoft QuickBASIC version 4.50. The QuickBASIC Interpreter QBI.EXE
1.00 environment is a subset of the QuickBASIC QB.EXE 4.50
environment, which is a separate product.)

The problem comes up after you select a game from the GAMESHOP.EXE
menu. After selecting a game to play, the screen blanks out and the
machine is apparently frozen. You can type CTRL+BREAK to break out of
the program and return to the DOS command line, but you still cannot
see anything on the screen. By typing CLS or another screen command,
your screen will return.

On some machines, you will see the following error statement:

   "ERROR 05 IN MODULE GAMESHOP"
   (Error 5 means "Illegal function call".)

Remove the /E:n option from the COMSPEC environment variable within
your AUTOEXEC.BAT file, and instead, set your environment size in your
CONFIG.SYS file. For example, use the following in your CONFIG.SYS
file:

   SHELL=C:\DOS\COMMAND.COM /E:256

The COMSPEC environment variable is used to set the drive, directory
path, and filename for COMMAND.COM, which is MS-DOS's command
interpreter. COMMAND.COM switches are not allowed in the COMSPEC
environment variable and may cause problems. The COMMAND.COM switches
should be set in the SHELL command in your CONFIG.SYS file as stated
above.

This is a limitation only when you are going through the menu in
GAMESHOP.EXE. You can still run QBI.EXE and run any game you want with
no problem. Because GAMESHOP.EXE uses a SHELL to run the games, the
invalid COMSPEC variable causes problems.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>