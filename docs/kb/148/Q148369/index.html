<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q148369: PC MAPI: Loss of Memory with MapiSendMail and Visual Basic | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q148369: PC MAPI: Loss of Memory with MapiSendMail and Visual Basic" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/148/Q148369/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/148/Q148369/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/148/Q148369/","headline":"Q148369: PC MAPI: Loss of Memory with MapiSendMail and Visual Basic","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q148369-pc-mapi-loss-of-memory-with-mapisendmail-and-visual-basic">Q148369: PC MAPI: Loss of Memory with MapiSendMail and Visual Basic</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q148369
Product(s): Microsoft Mail For PC Networks
Version(s): WINDOWS:3.5
Operating System(s): 
Keyword(s): 
Last Modified: 23-JAN-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail for Windows, version 3.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

When the MAPI function MAPISendMail is used in an application developed with
Microsoft Visual Basic versions 2.0 and 3.0 for Windows, the memory is not
released properly from the global heap. When you exit the MAPI application, it
will release the memory.

If the application sends large numbers of messages or several messages with
multiple recipients the heap memory could be exhausted and result in subsequent
failures of applications running in the Microsoft Windows environment.

When the MAPI application is stopped, the memory that was not released during
operation will be released and become available to other applications.

The amount of memory lost during the MAPISendMail function call will be on the
order of 32 bytes for each recipient and 32 bytes for each attached file. If the
Windows system has a few megabytes of available memory, it will take thousands
of messages to exhaust the heap. This is a problem only for a program designed
to run for long continuous periods.

CAUSE
=====

The loss of heap memory is a result of an error in MAPI.DLL and the way it frees
allocated memory. The memory fails to be released for each recipient and for
each attached file in the message. This loss only occurs when the Visual Basic
MAPI interface is used. It does not occur if the application uses the MAPI
interface for Microsoft C.

STATUS
======

Microsoft has confirmed this to be a problem in version 3.5 of Microsoft Mail
for Windows. A fix for this problem is in development, but has not been
regression-tested and may be destabilizing in production environments.

Contact Microsoft Product Support Services for more information on the
availability of this fix.

Additional query words: 3.00 3.20 3.20a 3.50

======================================================================
Keywords          :  
Technology        : kbMailSearch kbZNotKeyword3 kbMail350
Version           : WINDOWS:3.5

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>