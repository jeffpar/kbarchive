<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q318519: PRB: Error -2147467259 When VB Client Calls Method on COM Object | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q318519: PRB: Error -2147467259 When VB Client Calls Method on COM Object" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/318/Q318519/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/318/Q318519/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/318/Q318519/","headline":"Q318519: PRB: Error -2147467259 When VB Client Calls Method on COM Object","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q318519-prb-error--2147467259-when-vb-client-calls-method-on-com-object">Q318519: PRB: Error -2147467259 When VB Client Calls Method on COM Object</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q318519
Product(s): Microsoft Visual Basic for Windows
Version(s): 6.0
Operating System(s): 
Keyword(s): 
Last Modified: 04-MAR-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When a Visual Basic 6.0 client calls a method on a Component Object Model (COM)
object, the Visual Basic runtime may report the following error message:

  Run-time error '-2147467259 (80004005)': Method '~' of object '~' failed

Namely, the method call returns E_FAIL, but the object either does not implement
the ISupportErrorInfo interface or does not provide an error object by calling
the CreateErrorInfo function.


MORE INFORMATION
================

If you use proper error handling code, you can determine the server name that
contains the object that returns the error. This information is stored in the
Source property of the Err object. For example, the following code creates an
event log entry when the error occurs:

  Private Sub TestSub()
      On Error GoTo errHandler
      Dim o As TestServer.Class1
      Set o = New TestServer.Class1
      o.SomeMethod
      Exit Sub
  errHandler:
      App.LogEvent "Error in TestSub: " &amp; Err.Number &amp; "; Source: " &amp; Err.Source &amp; "; Description: " &amp; Err.Description
  End Sub

If the above-mentioned error occurs when o.SomeMethod is called, you can identify
the function name (TestSub), the error number [-2147467259 (80004005)], the
error source (TestServer), and the description (Method '~' of object '~'
failed). You can use this information to narrow the cause of the problem.

If you are debugging in the Visual Basic integrated development environment
(IDE), and if the COM object is running in process, you can obtain a more
specific error description that includes the object and method names. To
determine the root cause of the problem, debug the method of the object that
returns E_FAIL.

Additional query words:

======================================================================
Keywords          :  
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB600Search kbVB600
Version           : :6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>