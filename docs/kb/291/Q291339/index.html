<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q291339: SMS: Administrator Console/Services Can’t Connect to SQL Server | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q291339: SMS: Administrator Console/Services Can’t Connect to SQL Server" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/291/Q291339/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/291/Q291339/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/291/Q291339/","headline":"Q291339: SMS: Administrator Console/Services Can’t Connect to SQL Server","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q291339-sms-administrator-consoleservices-cant-connect-to-sql-server">Q291339: SMS: Administrator Console/Services Can’t Connect to SQL Server</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q291339
Product(s): Microsoft Systems Management Server
Version(s): 2.0
Operating System(s): 
Keyword(s): kbsms200
Last Modified: 06-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server version 2.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

In Systems Management Server (SMS) 2.0 sites in which both the site server and
the server that is running Microsoft SQL Server are located on the same
computer, the SMS Administrator console and the SMS services and threads may not
connect to the SQL database under certain conditions.

The following entry may be logged in the Smsprov.log file:

  E:\OPALSP2\Sdk_provider\Nt\Smsprov\SspObjectQuery.cpp(4233) : SQL Connection
  attempt timed out
  SQL Error: Unable to connect: SQL Server is unavailable or does not exist.
  General network error. Check your documentation.

The following entry may be logged in an SMS Executive service thread such as
Hman.log:

  ~Cannot connect to the site source on the database, sleep 10 minutes..

Other programs may not have SQL connectivity issues. For example, you may be able
to successfully connect with and run queries from the SQL Server Query Analyzer,
even from the SMS database. You may not notice any errors or warnings in the SQL
error log files.

CAUSE
=====

This issue may occur if you configured the LocalServer open database
connectivity (ODBC) data source name (DSN) entry for SQL Server to use a network
library other than the Named Pipes network library.


WORKAROUND
==========

To work around this issue:

1. Start the ODBC Data Source Administrator tool from Control Panel.

2. Click the System DSN tab, and then double click LocalServer.

3. Click Next.

4. Click Client Configuration.

5. Click Named Pipes in the Network Libraries section.

6. Click OK.

7. Make sure that "With Windows NT authentication using the network login ID" is
  selected.

8. Click Next, and then click Finish.

MORE INFORMATION
================

This issue has been reproduced using SQL 7.0 and SQL 2000 that is installed as
the database for SMS 2.0 Service Pack 2 (SP2) and Service Pack 3 (SP3) sites.

If a program or a user creates either a user or a system DSN that uses the SQL
Server driver, if the newly created DSN uses a network library other than the
Named Pipes library, all of the DSNs that use the SQL Server driver are
reconfigured to use the other network library.


Additional query words: prodsms ODBC DSN

======================================================================
Keywords          : kbsms200 
Technology        : kbSMSSearch kbSMS200
Version           : :2.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>