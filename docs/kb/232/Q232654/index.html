<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=231b77c990cb1dad78d33119176ff1f53331eb63">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Q232654: BUG:CommonDialog FilterIndex Always Returns Default Filter Index | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Q232654: BUG:CommonDialog FilterIndex Always Returns Default Filter Index" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/232/Q232654/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/232/Q232654/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/232/Q232654/","headline":"Q232654: BUG:CommonDialog FilterIndex Always Returns Default Filter Index","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q232654-bugcommondialog-filterindex-always-returns-default-filter-index">Q232654: BUG:CommonDialog FilterIndex Always Returns Default Filter Index</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q232654
Product(s): Microsoft Visual Basic for Windows
Version(s): 1.0,2.0,2.11,3.0
Operating System(s): 
Keyword(s): kbToolkit kbVBp600bug kbOSWinCEsearch kbGrpDSVB
Last Modified: 26-FEB-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows CE Toolkit for Visual Basic 6.0, version 1.0 
- Microsoft eMbedded Visual Basic, version 3.0, on platform(s):
   - Microsoft Windows CE versions 2.0, 2.11 for the Handheld PC 
   - Microsoft Windows CE version 2.11 for the Palm-size PC 
-------------------------------------------------------------------------------

SYMPTOMS
========

The FilterIndex property of the CommonDialog control that ships with the
Microsoft Windows CE Toolkit for Visual Basic 6.0 (VBCE6) will always return the
index for the first defined filter despite being changed by the user at run
time.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

MORE INFORMATION
================

The following code will behave differently between VBCE and Visual Basic 6.0.

Steps to Reproduce Behavior
---------------------------

1. Start a new Windows CE HPC Project in Visual Basic.

2. Select Components from the Project menu and reference the Microsoft CE Common
  Dialog Control 6.0.

3. Add a Common dialog and a Command Button to Form1.

4. Paste the following code into Form1:

  Private Sub Command1_Click()
      CommonDialog1.Filter = "Text (*.txt)|*.txt|Pictures (*.bmp)|*.bmp"
      CommonDialog1.FilterIndex = 1
      CommonDialog1.ShowOpen
      
      MsgBox "FilterIndex: " &amp; CommonDialog1.FilterIndex
  End Sub

5. Run the project and click the Command Button.

6. Select a text file to open and notice that the message box will display
  "FilterIndex: 1."

7. Click the Command Button again and select a bitmap file to open.

Notice that the message box will again display "FilterIndex: 1," when it should
display "FilterIndex: 2." This is inconsistent with how the Visual Basic 6.0
CommonDialog control works where the FilterIndex will reflect the user's
selection.

REFERENCES
==========

Visual Basic 6.0 Online Help
Windows CE Toolkit for Visual Basic 6.0 Online Help

Additional query words: vbce vbce6 wince

======================================================================
Keywords          : kbToolkit kbVBp600bug kbOSWinCEsearch kbGrpDSVB 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword2 kbVBeMbSearch kbWinCETKVBSearch kbWinCESearch
Version           : :1.0,2.0,2.11,3.0
Issue type        : kbbug
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>