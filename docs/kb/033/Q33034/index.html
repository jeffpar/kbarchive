<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=4c5dc89ca309d19d6d9171a268a55a16d7399494">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Q33034: How to Trap CTRL+BREAK, CTRL+C on Standard &amp; Enhanced Keyboard | KnowledgeBase Archive</title>
<meta property="og:title" content="Q33034: How to Trap CTRL+BREAK, CTRL+C on Standard &amp; Enhanced Keyboard" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/033/Q33034/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/033/Q33034/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"name":null,"description":"An Archive of Early Microsoft KnowledgeBase Articles","author":null,"@type":"WebPage","url":"http://jeffpar.github.io/kbarchive/kb/033/Q33034/","publisher":null,"image":null,"headline":"Q33034: How to Trap CTRL+BREAK, CTRL+C on Standard &amp; Enhanced Keyboard","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="http://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q33034-how-to-trap-ctrlbreak-ctrlc-on-standard--enhanced-keyboard">Q33034: How to Trap CTRL+BREAK, CTRL+C on Standard &amp; Enhanced Keyboard</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q33034
Product(s): See article
Version(s): 2.00 2.10 3.00 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | B_BasicCom | mspl13_basic
Last Modified: 21-DEC-1989

The scan code for the BREAK key is &amp;H46 (listed as SCROLL LOCK on Page
237 of the "Microsoft QuickBASIC 4.0: BASIC Language Reference" manual
for Versions 4.00 and 4.00b). The CTRL+BREAK key combination is
trapped differently, depending on whether or not the program is run on
a standard or enhanced keyboard.

This information also applies to Microsoft QuickBASIC 4.50, Microsoft
BASIC Compiler Versions 6.00 and 6.00b for MS-DOS and MS OS/2, and to
Microsoft BASIC PDS Version 7.00 for MS-DOS and MS OS/2.

For a standard keyboard, CTRL+BREAK is defined as follows

   KEY n, CHR$(&amp;H04) + CHR$(&amp;H46)

where n is in the range 15 through 25 in QuickBASIC Version 4.00, and
in 15 through 20 in QuickBASIC Versions 2.00, 2.01, and 3.00.

On an enhanced keyboard, CTRL+BREAK is defined as follows:

   KEY n, CHR$(&amp;H84) + CHR$(&amp;H46)

Please note that you must make separate user-defined KEY statements
for trapping CTRL+BREAK in combination with the SHIFT, ALT, NUM LOCK,
and CAPS LOCK keys. The keyboard flags for these other key
combinations must be added together to define a given key sequence.

Examples of trapping CTRL+BREAK and CTRL+C (when the SHIFT, ALT, NUM
LOCK, or CAPS LOCK keys are NOT active) are shown below.

Code Example 1
--------------

KEY 15, CHR$(&amp;H84) + CHR$(&amp;H46)  'Traps CTRL+BREAK on enhanced keyboard.
KEY 16, CHR$(&amp;H4) + CHR$(&amp;H46)   'Traps CTRL+BREAK on standard keyboard.
KEY(15) ON
KEY(16) ON
ON KEY(16) GOSUB trap
ON KEY(15) GOSUB trap
FOR i = 1 TO 500
   PRINT i
NEXT
END
trap:
   PRINT "trapped"
   RETURN

Code Example 2
--------------

Use the following code to trap a CTRL+C on either keyboard (standard
or extended):

KEY 18, CHR$(&amp;H4)+CHR$(&amp;H2E)    ' The &amp;H4 is the CTRL Key
KEY (18) ON            ' The &amp;H2E is the C key
ON KEY(18) GOSUB ctrlctrap
10 : GOTO 10
END
ctrlctrap:
    PRINT "CONTROL+C Trapped"
    RETURN
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="http://github.com/jeffpar">jeffpar</a><br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


</body>
</html>